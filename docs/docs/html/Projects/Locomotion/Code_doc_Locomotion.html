

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Locomotion Code Doc &#8212; Behavioral Analysis 0.0.1 documentation</title>
    <link rel="stylesheet" href="../../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Locomotion Task Analysis" href="Locomotion_task.html" />
    <link rel="prev" title="Locomotion" href="index.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Locomotion_task.html" title="Locomotion Task Analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Locomotion"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Behavioral Analysis 0.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Locomotion</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Locomotion Code Doc</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-Locomotion">
<span id="locomotion-code-doc"></span><h1>Locomotion Code Doc<a class="headerlink" href="#module-Locomotion" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="Locomotion.MWW_test">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">MWW_test</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">result</span></em>, <em class="sig-param"><span class="n">result_Ctr</span></em>, <em class="sig-param"><span class="n">mouse_type</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.MWW_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Return two-sided Mann-Whitney test for ON-laser period velocity between Ctr and ChR2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<em>df</em>) – a data frame containing mean velocity for ChR2 mice.</p></li>
<li><p><strong>result_Ctr</strong> (<em>df</em>) – a data frame containing mean velocity for Control mice.</p></li>
<li><p><strong>mouse_type</strong> (<em>str</em>) – mouse type as a string e.g. FoxP2, D2, Vglut2 ..</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>stat</strong> – MWW stat results</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.Plot_ON_OFF_V_mean">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">Plot_ON_OFF_V_mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">result</span></em>, <em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">mouse_type</span></em>, <em class="sig-param"><span class="n">folder</span></em>, <em class="sig-param"><span class="n">fps</span></em>, <em class="sig-param"><span class="n">back_front_boundary</span></em>, <em class="sig-param"><span class="n">v_threshold</span></em>, <em class="sig-param"><span class="n">pre_stim_inter</span></em>, <em class="sig-param"><span class="n">ylim</span><span class="o">=</span><span class="default_value">[- 20, 15]</span></em>, <em class="sig-param"><span class="n">save_as_format</span><span class="o">=</span><span class="default_value">'.pdf'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.Plot_ON_OFF_V_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the mean laser-ON laser-OFF vellociry with distinction of velocity prior to laser stim.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<em>dataframe</em>) – dataframe containing information of all animals</p></li>
<li><p><strong>path</strong> (<em>str</em>) – Path to save the figure</p></li>
<li><p><strong>folder</strong> (<em>str</em>) – Folder containing the experiment sessions</p></li>
<li><p><strong>back_front_boundary</strong> (<em>float</em>) – Threshold to set the position of the animal before the laser onset as either ‘back’ or ‘front’</p></li>
<li><p><strong>v_threshold</strong> (<em>float</em>) – Threshold to set the velocity of the animal before the laser onset as either ‘pos’ or ‘neg’</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – Y axis limits for the figure, default set to [-20,15]</p></li>
<li><p><strong>save_as_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Format to save the figure default is ‘.pdf’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.Plot_ON_OFF_X_V_mean">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">Plot_ON_OFF_X_V_mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">result</span></em>, <em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">mouse_type</span></em>, <em class="sig-param"><span class="n">folder</span></em>, <em class="sig-param"><span class="n">fps</span></em>, <em class="sig-param"><span class="n">back_front_boundary</span></em>, <em class="sig-param"><span class="n">v_threshold</span></em>, <em class="sig-param"><span class="n">pre_stim_inter</span></em>, <em class="sig-param"><span class="n">ylim</span><span class="o">=</span><span class="default_value">[- 20, 15]</span></em>, <em class="sig-param"><span class="n">save_as_format</span><span class="o">=</span><span class="default_value">'.pdf'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.Plot_ON_OFF_X_V_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the mean laser-ON laser-OFF vellociry with distinction of velocity and x prior to laser stim.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<em>dataframe</em>) – dataframe containing information of all animals</p></li>
<li><p><strong>path</strong> (<em>str</em>) – Path to save the figure</p></li>
<li><p><strong>folder</strong> (<em>str</em>) – Folder containing the experiment sessions</p></li>
<li><p><strong>back_front_boundary</strong> (<em>float</em>) – Threshold to set the position of the animal before the laser onset as either ‘back’ or ‘front’</p></li>
<li><p><strong>v_threshold</strong> (<em>float</em>) – Threshold to set the velocity of the animal before the laser onset as either ‘pos’ or ‘neg’</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – Y axis limits for the figure, default set to [-20,15]</p></li>
<li><p><strong>save_as_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Format to save the figure default is ‘.pdf’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.align_right_left">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">align_right_left</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">right</span></em>, <em class="sig-param"><span class="n">left</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.align_right_left" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct if for any reason there has been a shift between labelings of right and left side</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>right</strong> (<em>1-D array</em>) – position in time detected from the right camera</p></li>
<li><p><strong>left</strong> (<em>1-D array</em>) – position in time detected from the left camera</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.average_position_r_l">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">average_position_r_l</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">window</span></em>, <em class="sig-param"><span class="n">misdetection_dict</span></em>, <em class="sig-param"><span class="n">cor</span></em>, <em class="sig-param"><span class="n">body_part</span></em>, <em class="sig-param"><span class="n">plot_param</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.average_position_r_l" title="Permalink to this definition">¶</a></dt>
<dd><p>Return three-level correction of the average between right and left side for multiple selected body-parts.</p>
<p>Extract the right and left trace for each selected body part, correct right and left traces with
“compare_r_l_correct_misdetect”, then average over right and left and remove jitters by calling
“correct_labeling_jitter”. Then return the moving average of all selected body-parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>dataframe</em>) – Dataframe derived from DLC for one session of one animal</p></li>
<li><p><strong>window</strong> (<em>int</em>) – Moving average window for smoothing the position time series</p></li>
<li><p><strong>misdetection_dict</strong> (<em>dict-like</em>) – dict-like containing constants for misdetection corrections</p></li>
<li><p><strong>cor</strong> (<em>str</em>) – Which coordinate to work with. e.g. ‘x’ or ‘y’</p></li>
<li><p><strong>body_part</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – Which body parts to average over.</p></li>
<li><p><strong>plot_param</strong> (<em>str</em>) – Parameter for analysis e.g. position or velocity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>corrected_averaged</strong> – Moving average of all selected body-parts.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1-D array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.categorize_pre_x_and_v">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">categorize_pre_x_and_v</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">result</span></em>, <em class="sig-param"><span class="n">back_front_boundary</span></em>, <em class="sig-param"><span class="n">v_threshold</span></em>, <em class="sig-param"><span class="n">pre_stim_inter</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.categorize_pre_x_and_v" title="Permalink to this definition">¶</a></dt>
<dd><p>Set threshold to velocity and x position averaged over pre_stim_inter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<em>dataframe</em>) – dataframe containing information of all animals</p></li>
<li><p><strong>back_front_boundary</strong> (<em>float</em>) – Threshold to set the position of the animal before the laser onset as either ‘back’ or ‘front’</p></li>
<li><p><strong>v_threshold</strong> (<em>float</em>) – Threshold to set the velocity of the animal before the laser onset as either ‘pos’ or ‘neg’</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – the dataframe as the input but with the difference that pre_X_front_back and
pre_velocity_pos_neg set to binary(str) values accorfing to values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.compare_r_l_correct_misdetect">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">compare_r_l_correct_misdetect</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">right_p</span></em>, <em class="sig-param"><span class="n">left_p</span></em>, <em class="sig-param"><span class="n">acc_deviance</span></em>, <em class="sig-param"><span class="n">t_s</span></em>, <em class="sig-param"><span class="n">internal_ctr_dev</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">percent_thresh_align</span><span class="o">=</span><span class="default_value">0.8</span></em>, <em class="sig-param"><span class="n">n_iter_jitter</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">jitter_threshold</span><span class="o">=</span><span class="default_value">0.5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.compare_r_l_correct_misdetect" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Compare the right and left sides and correct if the difference between</dt><dd><p>the two is more than an acceptable amount.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>right_p</strong> (<em>1-D array</em>) – Position in time detected from the right camera</p></li>
<li><p><strong>left_p</strong> (<em>1-D array</em>) – Position in time detected from the left camera</p></li>
<li><p><strong>acc_deviance</strong> (<em>float</em>) – Passed within misdetect dict-like. Acceptable deviance of the right and left side detections</p></li>
<li><p><strong>t_s</strong> (<em>int</em>) – The number of procedeeing and post time bins to average from and correct the misdetection with</p></li>
<li><p><strong>internal_ctr_dev</strong> (<em>float</em>) – The threshold (cm) by which it is allowed for left and right detections to differ.</p></li>
<li><p><strong>percent_thresh_align</strong> (<em>int</em>) – The percentage above which it’s decided that there is a systematic shift between the right and left side detections.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>right</strong> (<em>1-D array</em>) – Corrected position in time detected from the right camera</p></li>
<li><p><strong>left</strong> (<em>1-D array</em>) – Corrected position in time detected from the left camera</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.convert_csv_to_xlsx">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">convert_csv_to_xlsx</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.convert_csv_to_xlsx" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a .xlsx version of all the .csv files exists, if not convert to this format
and remove the .csv to save space</p>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.correct_labeling_jitter">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">correct_labeling_jitter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">jitter_threshold</span></em>, <em class="sig-param"><span class="n">n_iter_jitter</span></em>, <em class="sig-param"><span class="n">t_s</span></em>, <em class="sig-param"><span class="n">acc_deviance</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">internal_ctr_dev</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">percent_thresh_align</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.correct_labeling_jitter" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct the detections exceeding the max speed of the mouse.</p>
<p>The detected jitters are replaced by the average of before and after time stamps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>1-D array</em>) – The time series that needs correction (usually the average of right and left cameras).</p></li>
<li><p><strong>jitter_threshold</strong> (<em>float</em>) – The allowed maximum movement in one timebin with the max allowed velocity.</p></li>
<li><p><strong>n_iter_jitter</strong> (<em>int</em>) – Number of times to repeat the correction algorithm.</p></li>
<li><p><strong>t_s</strong> (<em>int</em>) – The number of timebins to average from when correcting the jitter point.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x</strong> – The corrected time series.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1-D array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.derivative">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">derivative</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">delta_t</span></em>, <em class="sig-param"><span class="n">fps</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Take the derivative over delta_t.</p>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.derivative_mov_ave">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">derivative_mov_ave</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">delta_t</span></em>, <em class="sig-param"><span class="n">window_veloc</span></em>, <em class="sig-param"><span class="n">fps</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.derivative_mov_ave" title="Permalink to this definition">¶</a></dt>
<dd><p>Take the derivative with delta_t and do a moving average.</p>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.epochs_single_file">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">epochs_single_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name_pos</span></em>, <em class="sig-param"><span class="n">file_name_spont</span></em>, <em class="sig-param"><span class="n">file_name_laser</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.epochs_single_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a single file for a mouse and return the epochs.</p>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.extract_epochs">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">extract_epochs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bins</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">smallest_accep_inter</span></em>, <em class="sig-param"><span class="n">largest_accep_inter</span></em>, <em class="sig-param"><span class="n">pre_interval</span></em>, <em class="sig-param"><span class="n">interval</span></em>, <em class="sig-param"><span class="n">post_interval</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.extract_epochs" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the (pre | Laser ON | post) epochs.</p>
<p>Check reported (start,end) of trials from bins and discard trial with unacceptable duration.
Return the stacked the corresponding frames of all trials from the measurment array x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bins</strong> (<em>2D-array</em><em>(</em><em>int</em><em>)</em>) – array of start and end times for trials</p></li>
<li><p><strong>smallest_accep_inter</strong> (<em>int</em>) – Smallest acceptable duration of an interval in frames</p></li>
<li><p><strong>largest_accep_inter</strong> (<em>int</em>) – Largest acceptable duration of an interval in frames</p></li>
<li><p><strong>pre_interval</strong> (<em>int</em>) – Number of time bins to be taken into account before laser onset</p></li>
<li><p><strong>interval</strong> (<em>int</em>) – Laser duration in timebins.</p></li>
<li><p><strong>post_interval</strong> (<em>int</em>) – Number of time bins to be taken into account after laser onset</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>epochs</strong> (<em>2D array(float)</em>) – Trials containtning laser stimulation aligned in rows. n_col = pre_interval + interval + post_interval</p></li>
<li><p><strong>n_trials</strong> (<em>int</em>) – Number of trials</p></li>
<li><p><strong>take</strong> (<em>1D array(int)</em>) – Array of indices corresponding to pre | on | post epoch frmaes.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.extract_epochs_over_trials">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">extract_epochs_over_trials</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">files_list</span></em>, <em class="sig-param"><span class="n">files_list_laser</span></em>, <em class="sig-param"><span class="n">direct</span></em>, <em class="sig-param"><span class="n">folder</span></em>, <em class="sig-param"><span class="n">scale_pix_to_cm</span></em>, <em class="sig-param"><span class="n">spont</span></em>, <em class="sig-param"><span class="n">accep_interval_range</span></em>, <em class="sig-param"><span class="n">spont_trial_dict</span></em>, <em class="sig-param"><span class="n">misdetection_dict</span></em>, <em class="sig-param"><span class="n">study_param_dict</span></em>, <em class="sig-param"><span class="n">pre_interval</span></em>, <em class="sig-param"><span class="n">interval</span></em>, <em class="sig-param"><span class="n">post_interval</span></em>, <em class="sig-param"><span class="n">pre_stim_inter</span></em>, <em class="sig-param"><span class="n">fps</span></em>, <em class="sig-param"><span class="n">n_timebin</span></em>, <em class="sig-param"><span class="n">window_veloc</span></em>, <em class="sig-param"><span class="n">window_pos</span></em>, <em class="sig-param"><span class="n">no_sample</span><span class="o">=</span><span class="default_value">25</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.extract_epochs_over_trials" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all the epochs of all similar trials for one mouse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>files_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – List of paths to all DLC .csv files for sessions</p></li>
<li><p><strong>files_list_laser</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – List of paths to all .csv files that have (start,end) laser times.</p></li>
<li><p><strong>direct</strong> (<em>str</em>) – Path to the parent directory containing all folders</p></li>
<li><p><strong>folder</strong> (<em>str</em>) – folder containing sessions for this particular protocol</p></li>
<li><p><strong>scale_pix_to_cm</strong> (<em>float</em>) – Scaling coefficient converting pixels to cm</p></li>
<li><p><strong>spont</strong> (<em>str</em>) – Either ‘n’ –&gt; for trials containing laser stimulation
or ‘y’ –&gt; for spontaneous trials with no laser</p></li>
<li><p><strong>accep_interval_range</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>) – Smallest and largest acceptable trial sizes in timebins</p></li>
<li><p><strong>spont_trial_dict</strong> (<em>dict-like</em>) – {‘max_distance’ : int (max n_timebins between sampled epochs for spontaneous),
‘min_distance’ : int (min #n_timebines between sampled epochs for spontaneous),
‘n_trials_spont’ : int (the average number of trials extracted from one spontaneous session)}</p></li>
<li><p><strong>misdetection_dict</strong> (<em>dict-like</em>) – Dictionary of constants used in the misdetection correction algorithm:
{‘acc_deviance’ : float  (acceptable deviance between right and left detections),
‘internal_ctr_dev’ : float,
‘percent_thresh_align’ : int,
‘t_s’ : int (number of time steps before and after to look at),
‘n_iter_jitter’ : int (how many times go over data to find jitters and clear them out),
‘jitter_threshold’ : int (max_speed/fps)}</p></li>
<li><p><strong>study_param_dict</strong> (<em>dict-like</em>) – Dictionary of values regarding coordinate (x,y), body part (list of body parts) and plot parameter
(position, velocity, acceleration) packed from input of user</p></li>
<li><p><strong>pre_interval</strong> (<em>int</em>) – Number of time bins to be taken into account before laser onset</p></li>
<li><p><strong>interval</strong> (<em>int</em>) – Laser duration in timebins.</p></li>
<li><p><strong>post_interval</strong> (<em>int</em>) – Number of time bins to be taken into account after laser onset</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
<li><p><strong>fps</strong> (<em>int</em>) – Frame per second of the video</p></li>
<li><p><strong>n_timebin</strong> (<em>int</em>) – Number of frames as timebins for the x derivative to yields velocity</p></li>
<li><p><strong>window_veloc</strong> (<em>int</em>) – Velocity moving average window in frames</p></li>
<li><p><strong>window_pos</strong> (<em>int</em>) – Position moving average window in frames</p></li>
<li><p><strong>no_sample</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples to extract from one spontaneous session. Only necessary for spont = ‘y’ cases.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>epochs</strong> (<em>2D array(float)</em>) – (pre | Laser ON | post) epochs with shape (n_trials, pre_interval+post_interval+interval+1)</p></li>
<li><p><strong>pre_info</strong> (<em>2D array(float)</em>) – Three columns with averages of : pre_x , pre_v, pre_acceleration over pre_stim_interval duration.
with shape (n_trials, 3)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.extract_epochs_over_trials_one_side_one_body_part">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">extract_epochs_over_trials_one_side_one_body_part</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">files_list_DLC</span></em>, <em class="sig-param"><span class="n">files_list_Laser</span></em>, <em class="sig-param"><span class="n">direct</span></em>, <em class="sig-param"><span class="n">folder</span></em>, <em class="sig-param"><span class="n">scale_pix_to_cm</span></em>, <em class="sig-param"><span class="n">accep_interval_range</span></em>, <em class="sig-param"><span class="n">misdetection_dict</span></em>, <em class="sig-param"><span class="n">pre_interval</span></em>, <em class="sig-param"><span class="n">interval</span></em>, <em class="sig-param"><span class="n">post_interval</span></em>, <em class="sig-param"><span class="n">fps</span></em>, <em class="sig-param"><span class="n">n_timebin</span></em>, <em class="sig-param"><span class="n">window_veloc</span></em>, <em class="sig-param"><span class="n">window_pos</span></em>, <em class="sig-param"><span class="n">cor</span></em>, <em class="sig-param"><span class="n">body_part</span></em>, <em class="sig-param"><span class="n">plot_param</span></em>, <em class="sig-param"><span class="n">left_or_right</span><span class="o">=</span><span class="default_value">'right'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.extract_epochs_over_trials_one_side_one_body_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all the epochs of all simillar trials for one mouse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>files_list_DLC</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – List of paths to all DLC .csv files for sessions</p></li>
<li><p><strong>files_list_laser</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – List of paths to all .csv files that have (start,end) laser times.</p></li>
<li><p><strong>direct</strong> (<em>str</em>) – Path to the parent directory containing all folders</p></li>
<li><p><strong>folder</strong> (<em>str</em>) – Folder containing sessions for this protocol</p></li>
<li><p><strong>scale_pix_to_cm</strong> (<em>float</em>) – </p></li>
<li><p><strong>accep_interval_range</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>) – Smallest and largest acceptable trial sizes in timebins</p></li>
<li><p><strong>misdetection_dict</strong> (<em>dict-like</em>) – dictionary of constants used in the misdetection correction algorithm:
{‘acc_deviance’ : float  (acceptable deviance between right and left detections),
‘internal_ctr_dev’ : float,
‘percent_thresh_align’ : int,
‘t_s’ : int (number of time steps before and after to look at),
‘n_iter_jitter’ : int (how many times go over data to find jitters and clear them out),
‘jitter_threshold’ : int (max_speed/fps)}</p></li>
<li><p><strong>pre_interval</strong> (<em>int</em>) – Number of time bins to be taken into account before laser onset</p></li>
<li><p><strong>interval</strong> (<em>int</em>) – Laser duration in timebins.</p></li>
<li><p><strong>post_interval</strong> (<em>int</em>) – Number of time bins to be taken into account after laser onset</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
<li><p><strong>fps</strong> (<em>int</em>) – Frame per second of the video</p></li>
<li><p><strong>n_timebin</strong> (<em>int</em>) – Number of frames as timebins for the x derivative to yields velocity</p></li>
<li><p><strong>window_veloc</strong> (<em>int</em>) – Velocity moving average window in frames</p></li>
<li><p><strong>window_pos</strong> (<em>int</em>) – Position moving average window in frames</p></li>
<li><p><strong>left_or_right</strong> (<em>str</em><em>, </em><em>optional</em>) – Either left side or right side. Default value is set to ‘right’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>epochs</strong> – (pre | Laser ON | post) epochs with shape (n_trials, pre_interval+post_interval+interval+1)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D-array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.extract_pre_laser_x_epochs_over_trials">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">extract_pre_laser_x_epochs_over_trials</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">files_list</span></em>, <em class="sig-param"><span class="n">files_list_laser</span></em>, <em class="sig-param"><span class="n">pre_direct</span></em>, <em class="sig-param"><span class="n">folder</span></em>, <em class="sig-param"><span class="n">scale_pix_to_cm</span></em>, <em class="sig-param"><span class="n">window_pos</span></em>, <em class="sig-param"><span class="n">misdetection_dict</span></em>, <em class="sig-param"><span class="n">smallest_accep_inter</span></em>, <em class="sig-param"><span class="n">largest_accep_inter</span></em>, <em class="sig-param"><span class="n">pre_stim_inter</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.extract_pre_laser_x_epochs_over_trials" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all the x positions in epochs preceding to a ON-laser of all trials for one mouse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>files_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – List of the file names of the sessions</p></li>
<li><p><strong>files_list_laser</strong> – List of file names for laser detections</p></li>
<li><p><strong>pre_direct</strong> (<em>str</em>) – Path to the root directory of the project</p></li>
<li><p><strong>folder</strong> (<em>str</em>) – Folder containing this specific protocol.</p></li>
<li><p><strong>scale_pix_to_cm</strong> (<em>float</em>) – Scaling coeficient for pixels to cm.</p></li>
<li><p><strong>window_pos</strong> (<em>int</em>) – Moving average window for position</p></li>
<li><p><strong>misdetection_dict</strong> (<em>dict-like</em>) – dict-like containing constants for misdetection corrections</p></li>
<li><p><strong>smallest_accep_inter</strong> (<em>int</em>) – Smallest acceptable duration of an interval in frames</p></li>
<li><p><strong>largest_accep_inter</strong> (<em>int</em>) – Largest acceptable duration of an interval in frames</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>epochs</strong> – X positions prior to laser stimulation aligned in rows. n_col = pre_stim_inter</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D array(float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.get_input_cor_body_part">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">get_input_cor_body_part</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cor_list</span></em>, <em class="sig-param"><span class="n">body_part_list</span></em>, <em class="sig-param"><span class="n">plot_param_list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.get_input_cor_body_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Ask for the body part and coordinate from user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cor_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – list of available coordinates e.g. ‘x’, ‘y’</p></li>
<li><p><strong>body_part_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – list of DLC labeled body parts</p></li>
<li><p><strong>plot_param_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – List of available parameters for analysis e.g position or velocity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>study_param_dict</strong> – selected items from the options in the inputs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.input_plot">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">input_plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">laser_t</span></em>, <em class="sig-param"><span class="n">mouse_type</span></em>, <em class="sig-param"><span class="n">mouse_no</span></em>, <em class="sig-param"><span class="n">trial_no</span></em>, <em class="sig-param"><span class="n">opto_par</span></em>, <em class="sig-param"><span class="n">pre_direct</span></em>, <em class="sig-param"><span class="n">exp_dict</span></em>, <em class="sig-param"><span class="n">t_window_dict</span></em>, <em class="sig-param"><span class="n">misdetection_dict</span></em>, <em class="sig-param"><span class="n">save_as_format</span><span class="o">=</span><span class="default_value">'.pdf'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.input_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the specifics of the plot as input and call the corresponding plot function to plot the session.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>Dataframe</em>) – Dataframe derived from DLC for one session of one animal</p></li>
<li><p><strong>laser_t</strong> (<em>Dataframe</em>) – Dataframe with laser onset and offset times as columns</p></li>
<li><p><strong>mouse_type</strong> (<em>str</em>) – Mouse type. For example <cite>FoxP2</cite></p></li>
<li><p><strong>mouse_no</strong> (<em>int</em>) – Mouse number</p></li>
<li><p><strong>trial_no</strong> (<em>int</em>) – Trial number specified in file name</p></li>
<li><p><strong>opto_par</strong> (<em>str</em>) – Optogenetic specification. For example <cite>ChR2</cite> or <cite>Control</cite></p></li>
<li><p><strong>pre_direct</strong> (<em>str</em>) – Path to the root directory of the project</p></li>
<li><p><strong>exp_dict</strong> (<em>dict-like</em>) – Experiment dictionary for cor_list, body_part_list and plot_param_list</p></li>
<li><p><strong>t_window_dict</strong> (<em>dict-like</em>) – Dictionary of time constants</p></li>
<li><p><strong>misdetection_dict</strong> (<em>dict-like</em>) – Dictionary for misdetection algorithm constants</p></li>
<li><p><strong>save_as_format</strong> (<em>str</em><em>, </em><em>optional</em>) – The extension of the saved figure</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.lighten_color">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">lighten_color</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">color</span></em>, <em class="sig-param"><span class="n">amount</span><span class="o">=</span><span class="default_value">0.5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.lighten_color" title="Permalink to this definition">¶</a></dt>
<dd><p>Lightens the given color by multiplying (1-luminosity) by the given amount.
Input can be matplotlib color string, hex string, or RGB tuple.</p>
<p>Examples:
&gt;&gt; lighten_color(‘g’, 0.3)
&gt;&gt; lighten_color(‘#F034A3’, 0.6)
&gt;&gt; lighten_color((.3,.55,.1), 0.5)</p>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.list_all_files">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">list_all_files</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">extension</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.list_all_files" title="Permalink to this definition">¶</a></dt>
<dd><p>List all the files with this extention in this directory</p>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.min_and_mean_on_off">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">min_and_mean_on_off</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">epochs</span></em>, <em class="sig-param"><span class="n">measure</span></em>, <em class="sig-param"><span class="n">pre_interval</span></em>, <em class="sig-param"><span class="n">interval</span></em>, <em class="sig-param"><span class="n">post_interval</span></em>, <em class="sig-param"><span class="n">pre_stim_inter</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.min_and_mean_on_off" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the min or mean (specified by measure) velocity in the off-on periods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epochs</strong> (<em>2D array</em><em>(</em><em>float</em><em>)</em>) – Trial variables in rows. n_col = pre_interval + interval + post_interval</p></li>
<li><p><strong>measure</strong> (<em>str</em>) – ‘mean’ or ‘min’</p></li>
<li><p><strong>pre_interval</strong> (<em>int</em>) – Number of time bins to be taken into account before laser onset</p></li>
<li><p><strong>interval</strong> (<em>int</em>) – Laser duration in timebins.</p></li>
<li><p><strong>post_interval</strong> (<em>int</em>) – Number of time bins to be taken into account after laser onset</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Unpacked in dict-like. Not used here.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>average_of_off_on_off</strong> – array of 3 columns. first column is the aversge of pre-intevsl,
second the ‘measure’ during laser interval
third again the average of post</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.min_velocity_diff_inten_box_plot">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">min_velocity_diff_inten_box_plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_path_list</span></em>, <em class="sig-param"><span class="n">path_to_save</span></em>, <em class="sig-param"><span class="n">intervals_dict</span></em>, <em class="sig-param"><span class="n">pre_x_v_dict</span></em>, <em class="sig-param"><span class="n">ylim</span><span class="o">=</span><span class="default_value">[- 40, 15]</span></em>, <em class="sig-param"><span class="n">save_as_format</span><span class="o">=</span><span class="default_value">'.pdf'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.min_velocity_diff_inten_box_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare min velocity during laser for trials with positive and negative pre laser velocity.</p>
<p>Box plots to show this comparison for different intensity in same animal types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – list of paths to .npz files</p></li>
<li><p><strong>path_to_save</strong> (<em>str</em>) – Path to save figure</p></li>
<li><p><strong>intervals_dict</strong> (<em>dict-like</em>) – <dl class="simple">
<dt>dict-like of interals:{‘pre_interval’<span class="classifier">int(.5*fps), # interval before laser onset</span></dt><dd><p>’interval’ : int(interval_in_sec * fps), # number of timebins of stimulation
‘post_interval’ : int(.5*fps*2), # interval after laser onset
‘pre_stim_inter’ : pre_stim_inter }</p>
</dd>
</dl>
</p></li>
<li><p><strong>pre_x_v_dict</strong> (<em>dict-like</em>) – <dl class="simple">
<dt>{‘back_front_boundary’<span class="classifier">(treadmill_len-elec_shock)/2, # set the limit below which is considered back of the treadmill</span></dt><dd><p>’v_threshold’ : 0,
‘pre_stim_inter’ : pre_stim_inter # number of timebins in the pre-stimulus period}</p>
</dd>
</dl>
</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – y axis limits for figure. Default is set to [-40,15]</p></li>
<li><p><strong>save_as_format</strong> (<em>str</em><em>, </em><em>optional</em>) – format to save the figure. Default is set to ‘.pdf’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.min_velocity_mouse_type_box_plot">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">min_velocity_mouse_type_box_plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_path_list</span></em>, <em class="sig-param"><span class="n">path_to_save</span></em>, <em class="sig-param"><span class="n">intervals_dict</span></em>, <em class="sig-param"><span class="n">pre_x_v_dict</span></em>, <em class="sig-param"><span class="n">ylim</span><span class="o">=</span><span class="default_value">[- 40, 15]</span></em>, <em class="sig-param"><span class="n">save_as_format</span><span class="o">=</span><span class="default_value">'.pdf'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.min_velocity_mouse_type_box_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare min velocity during laser.</p>
<p>Box plots to show this comparison FOR trials with positive and negative
pre laser velocity for same intensity in different animal types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – list of paths to .npz files</p></li>
<li><p><strong>path_to_save</strong> (<em>str</em>) – Path to save figure</p></li>
<li><p><strong>intervals_dict</strong> (<em>dict-like</em>) – <dl class="simple">
<dt>dict-like of interals:{‘pre_interval’<span class="classifier">int(.5*fps), # interval before laser onset</span></dt><dd><p>’interval’ : int(interval_in_sec * fps), # number of timebins of stimulation
‘post_interval’ : int(.5*fps*2), # interval after laser onset
‘pre_stim_inter’ : pre_stim_inter }</p>
</dd>
</dl>
</p></li>
<li><p><strong>pre_x_v_dict</strong> (<em>dict-like</em>) – <dl class="simple">
<dt>{‘back_front_boundary’<span class="classifier">(treadmill_len-elec_shock)/2, # set the limit below which is considered back of the treadmill</span></dt><dd><p>’v_threshold’ : 0,
‘pre_stim_inter’ : pre_stim_inter # number of timebins in the pre-stimulus period}</p>
</dd>
</dl>
</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – y axis limits for figure. Default is set to [-40,15]</p></li>
<li><p><strong>save_as_format</strong> (<em>str</em><em>, </em><em>optional</em>) – format to save the figure. Default is set to ‘.pdf’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.moving_average_array">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">moving_average_array</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.moving_average_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the moving average over X with window n without changing dimesions of X</p>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.plot_every_mouse_mean">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">plot_every_mouse_mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">epochs_mean_each_mouse</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.plot_every_mouse_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>plot mean of each mouse for epochs OFF-ON-OFF</p>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.plot_phase_space_V">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">plot_phase_space_V</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">result</span></em>, <em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">mouse_type</span></em>, <em class="sig-param"><span class="n">folder</span></em>, <em class="sig-param"><span class="n">fps</span></em>, <em class="sig-param"><span class="n">back_front_boundary</span></em>, <em class="sig-param"><span class="n">v_threshold</span></em>, <em class="sig-param"><span class="n">pre_stim_inter</span></em>, <em class="sig-param"><span class="n">xlim</span><span class="o">=</span><span class="default_value">[- 25, 32]</span></em>, <em class="sig-param"><span class="n">ylim</span><span class="o">=</span><span class="default_value">[- 30, 40]</span></em>, <em class="sig-param"><span class="n">save_as_format</span><span class="o">=</span><span class="default_value">'.pdf'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.plot_phase_space_V" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the phase space of laser-ON vs. laser-OFF velocity for all trials of all mice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<em>dataframe</em>) – dataframe containing information of all animals</p></li>
<li><p><strong>path</strong> (<em>str</em>) – Path to save the figure</p></li>
<li><p><strong>folder</strong> (<em>str</em>) – Folder containing the experiment sessions</p></li>
<li><p><strong>back_front_boundary</strong> (<em>float</em>) – Threshold to set the position of the animal before the laser onset as either ‘back’ or ‘front’</p></li>
<li><p><strong>v_threshold</strong> (<em>float</em>) – Threshold to set the velocity of the animal before the laser onset as either ‘pos’ or ‘neg’</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – X axis limits for the figure, default set to [-25,32]</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – Y axis limits for the figure, default set to [-20,15]</p></li>
<li><p><strong>save_as_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Format to save the figure default is ‘.pdf’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.plot_pre_on_post">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">plot_pre_on_post</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em>, <em class="sig-param"><span class="n">pre_direct</span></em>, <em class="sig-param"><span class="n">mouse_type</span></em>, <em class="sig-param"><span class="n">opto_par</span></em>, <em class="sig-param"><span class="n">folder</span></em>, <em class="sig-param"><span class="n">epochs</span></em>, <em class="sig-param"><span class="n">epochs_spont</span></em>, <em class="sig-param"><span class="n">treadmil_velocity</span></em>, <em class="sig-param"><span class="n">ylim</span></em>, <em class="sig-param"><span class="n">fps</span></em>, <em class="sig-param"><span class="n">n_timebin</span></em>, <em class="sig-param"><span class="n">window_pos</span></em>, <em class="sig-param"><span class="n">window_veloc</span></em>, <em class="sig-param"><span class="n">cor</span></em>, <em class="sig-param"><span class="n">body_part</span></em>, <em class="sig-param"><span class="n">plot_param</span></em>, <em class="sig-param"><span class="n">pre_interval</span></em>, <em class="sig-param"><span class="n">interval</span></em>, <em class="sig-param"><span class="n">post_interval</span></em>, <em class="sig-param"><span class="n">pre_stim_inter</span></em>, <em class="sig-param"><span class="n">average</span><span class="o">=</span><span class="default_value">'Averg_trials_all_mice'</span></em>, <em class="sig-param"><span class="n">c_laser</span><span class="o">=</span><span class="default_value">'deepskyblue'</span></em>, <em class="sig-param"><span class="n">c_spont</span><span class="o">=</span><span class="default_value">'k'</span></em>, <em class="sig-param"><span class="n">save_as_format</span><span class="o">=</span><span class="default_value">'.pdf'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.plot_pre_on_post" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot (pre Laser | Laser | post Laser) velocity/position/acceleration comparison between laser and spontaneous trials.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>ax</em>) – </p></li>
<li><p><strong>pre_direct</strong> (<em>str</em>) – Path to project directory</p></li>
<li><p><strong>mouse_type</strong> (<em>str</em>) – Type of the animal that makes it different in the experiment e.g. for transgenic mice ‘FoxP&#64;’ or ‘Vglut2’.</p></li>
<li><p><strong>opto_par</strong> (<em>str</em>) – Optogentic parameter distinguishing injections. e.g. ‘Control’ or ‘ChR2’.</p></li>
<li><p><strong>folder</strong> (<em>str</em>) – folder containing this specific protocol’s sessions e.g. ‘Square_1_mW’</p></li>
<li><p><strong>epochs</strong> (<em>2D array</em><em>(</em><em>float</em><em>)</em>) – Trials containtning laser stimulation aligned in rows. n_col is equal to pre_interval + interval + post_interval</p></li>
<li><p><strong>epochs_spont</strong> (<em>2D array</em><em>(</em><em>float</em><em>)</em>) – Spontaneous trials aligned in rows. n_col is equal to pre_interval + interval + post_interval</p></li>
<li><p><strong>treadmill_velocity</strong> (<em>float</em>) – Treadmill velocity in cm/s</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>(</em><em>float</em><em>)</em>) – Y axis limits for the figure given as a list : [ymin, ymax]</p></li>
<li><p><strong>fps</strong> (<em>int</em>) – frame per second of the video</p></li>
<li><p><strong>n_timebin</strong> (<em>int</em>) – number of timebins for taking derivatives</p></li>
<li><p><strong>window_pos</strong> (<em>int</em>) – Moving average window for position</p></li>
<li><p><strong>window_veloc</strong> (<em>int</em>) – Moving average window for velocity</p></li>
<li><p><strong>cor</strong> (<em>str</em>) – Which coordinate to work with. e.g. ‘x’ or ‘y’</p></li>
<li><p><strong>body_part</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – Which body parts to average over.</p></li>
<li><p><strong>plot_param</strong> (<em>str</em>) – Parameter for analysis e.g. position or velocity.</p></li>
<li><p><strong>pre_interval</strong> (<em>int</em>) – Number of time bins to be taken into account before laser onset</p></li>
<li><p><strong>interval</strong> (<em>int</em>) – Laser duration in timebins.</p></li>
<li><p><strong>post_interval</strong> (<em>int</em>) – Number of time bins to be taken into account after laser onset</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
<li><p><strong>average</strong> (<em>str</em><em>, </em><em>optional</em>) – Parameter specifying the output figure. Here default set to ‘Averg_trials_all_mice’.</p></li>
<li><p><strong>c_laser</strong> (<em>str</em><em>, </em><em>optional</em>) – color for plotting trials with laser stimulation. Default value is set to ‘deepskyblue’.</p></li>
<li><p><strong>c_spont</strong> (<em>str</em><em>, </em><em>optional</em>) – color for plotting trials with laser stimulation. Default value is set to ‘k’ which is black.</p></li>
<li><p><strong>save_as_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Format to save the figure with. Default set to  ‘.pdf’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.plot_two_protocols_with_mouse_distinction">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">plot_two_protocols_with_mouse_distinction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mouse_type</span></em>, <em class="sig-param"><span class="n">mouse_list</span></em>, <em class="sig-param"><span class="n">folder1</span></em>, <em class="sig-param"><span class="n">folder2</span></em>, <em class="sig-param"><span class="n">opto_par</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.plot_two_protocols_with_mouse_distinction" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract data over all mice of one group in two folders intensity and plot with subplots of individual animals</p>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.plot_what_which_where">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">plot_what_which_where</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">laser_t</span></em>, <em class="sig-param"><span class="n">mouse_type</span></em>, <em class="sig-param"><span class="n">mouse_no</span></em>, <em class="sig-param"><span class="n">trial_no</span></em>, <em class="sig-param"><span class="n">opto_par</span></em>, <em class="sig-param"><span class="n">pre_direct</span></em>, <em class="sig-param"><span class="n">misdetection_dict</span></em>, <em class="sig-param"><span class="n">cor</span></em>, <em class="sig-param"><span class="n">body_part</span></em>, <em class="sig-param"><span class="n">plot_param</span></em>, <em class="sig-param"><span class="n">fps</span></em>, <em class="sig-param"><span class="n">n_timebin</span></em>, <em class="sig-param"><span class="n">window_pos</span></em>, <em class="sig-param"><span class="n">window_veloc</span></em>, <em class="sig-param"><span class="n">save_as_format</span><span class="o">=</span><span class="default_value">'.pdf'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.plot_what_which_where" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose to see averaged velocity, position or acceleration for a chosen combination of body_parts
for either x or y coordiante.</p>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.plot_what_which_where_r_l">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">plot_what_which_where_r_l</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">laser_t</span></em>, <em class="sig-param"><span class="n">mouse_type</span></em>, <em class="sig-param"><span class="n">mouse_no</span></em>, <em class="sig-param"><span class="n">trial_no</span></em>, <em class="sig-param"><span class="n">opto_par</span></em>, <em class="sig-param"><span class="n">pre_direct</span></em>, <em class="sig-param"><span class="n">misdetection_dict</span></em>, <em class="sig-param"><span class="n">cor</span></em>, <em class="sig-param"><span class="n">body_part</span></em>, <em class="sig-param"><span class="n">plot_param</span></em>, <em class="sig-param"><span class="n">fps</span></em>, <em class="sig-param"><span class="n">n_timebin</span></em>, <em class="sig-param"><span class="n">window_pos</span></em>, <em class="sig-param"><span class="n">window_veloc</span></em>, <em class="sig-param"><span class="n">save_as_format</span><span class="o">=</span><span class="default_value">'.pdf'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.plot_what_which_where_r_l" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose which body part/what measure/ x or y to see the left vs. right traces.</p>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.position_r_l">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">position_r_l</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">window</span></em>, <em class="sig-param"><span class="n">misdetection_dict</span></em>, <em class="sig-param"><span class="n">cor</span></em>, <em class="sig-param"><span class="n">body_part</span></em>, <em class="sig-param"><span class="n">plot_param</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.position_r_l" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove jitters with “correct_labeling_jitter” on right and left on the
selected body parts and return right and left separately.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>dataframe</em>) – Dataframe derived from DLC for one session of one animal</p></li>
<li><p><strong>window</strong> (<em>int</em>) – Moving average window for smoothing the position time series</p></li>
<li><p><strong>misdetection_dict</strong> (<em>dict-like</em>) – dict-like containing constants for misdetection corrections</p></li>
<li><p><strong>cor</strong> (<em>str</em>) – Which coordinate to work with. e.g. ‘x’ or ‘y’</p></li>
<li><p><strong>body_part</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – Which body parts to average over.</p></li>
<li><p><strong>plot_param</strong> (<em>str</em>) – Parameter for analysis e.g. position or velocity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>right_corrected</strong> (<em>1-D array</em>) – Moving average of right side for all selected body-parts</p></li>
<li><p><strong>left_corrected</strong> (<em>1-D array</em>) – Moving average of left side for all selected body-parts</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.produce_random_bins_for_spont">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">produce_random_bins_for_spont</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">max_time</span></em>, <em class="sig-param"><span class="n">n_sample</span></em>, <em class="sig-param"><span class="n">pre_interval</span></em>, <em class="sig-param"><span class="n">interval</span></em>, <em class="sig-param"><span class="n">post_interval</span></em>, <em class="sig-param"><span class="n">max_distance</span></em>, <em class="sig-param"><span class="n">min_distance</span></em>, <em class="sig-param"><span class="n">n_trials_spont</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.produce_random_bins_for_spont" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a grid for start of bins then perturb to have randomly
spaced trials with a minimum and maximum distance between them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_time</strong> (<em>int</em>) – number of timebins of the spontaneous session</p></li>
<li><p><strong>n_sample</strong> (<em>int</em>) – number of trial samples that needs to be extracted from this session</p></li>
<li><p><strong>max_distance</strong> (<em>int</em>) – maximum number of timebins between extracted trials</p></li>
<li><p><strong>min_distance</strong> (<em>int</em>) – minimum number of timebins between extracted trials</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>bins</strong> – an array with two columns each row containing (start,end) of each trial</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D-array(int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.read_DLC">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">read_DLC</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em>, <em class="sig-param"><span class="n">scale_pix_to_cm</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.read_DLC" title="Permalink to this definition">¶</a></dt>
<dd><p>Read DeepLabCut Data.</p>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.read_laser">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">read_laser</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">laser_file_name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.read_laser" title="Permalink to this definition">¶</a></dt>
<dd><p>Read laser onset offset times for Square pulse stimulation</p>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.read_laser_beta_stim">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">read_laser_beta_stim</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">laser_file_name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.read_laser_beta_stim" title="Permalink to this definition">¶</a></dt>
<dd><p>Read laser onset offset times for Beta pulse stimulation</p>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.read_npz_return_data_frame">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">read_npz_return_data_frame</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_path_list</span></em>, <em class="sig-param"><span class="n">pre_interval</span></em>, <em class="sig-param"><span class="n">interval</span></em>, <em class="sig-param"><span class="n">post_interval</span></em>, <em class="sig-param"><span class="n">pre_stim_inter</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.read_npz_return_data_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the saved .npz file and produce a data frame with the following columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – List of full paths to .npz files to be read</p></li>
<li><p><strong>pre_interval</strong> (<em>int</em>) – Number of time bins to be taken into account before laser onset</p></li>
<li><p><strong>interval</strong> (<em>int</em>) – Laser duration in timebins.</p></li>
<li><p><strong>post_interval</strong> (<em>int</em>) – Number of time bins to be taken into account after laser onset</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>result</strong> –</p>
<dl class="simple">
<dt>dataframe with following columns: [‘mean_velocity’, ‘min_velocity’, ‘mouse_type’, ‘optogenetic expression’,</dt><dd><p>’pulse_type’,’intensity_mW’,’epoch’,’pre_velocity_pos_neg’,’pre_x’,’pre_x_front_back’,’pre_accel’,’pre_accel_pos_neg’]</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.run_one_intensity_save_data">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">run_one_intensity_save_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pre_direct</span></em>, <em class="sig-param"><span class="n">scale_pix_to_cm</span></em>, <em class="sig-param"><span class="n">mouse_type</span></em>, <em class="sig-param"><span class="n">mouse_list</span></em>, <em class="sig-param"><span class="n">folder</span></em>, <em class="sig-param"><span class="n">opto_par</span></em>, <em class="sig-param"><span class="n">treadmil_velocity</span></em>, <em class="sig-param"><span class="n">ylim</span></em>, <em class="sig-param"><span class="n">spont_trial_dict</span></em>, <em class="sig-param"><span class="n">misdetection_dict</span></em>, <em class="sig-param"><span class="n">intervals_dict</span></em>, <em class="sig-param"><span class="n">t_window_dict</span></em>, <em class="sig-param"><span class="n">accep_interval_range</span></em>, <em class="sig-param"><span class="n">study_param_dict</span></em>, <em class="sig-param"><span class="n">max_distance</span></em>, <em class="sig-param"><span class="n">min_distance</span></em>, <em class="sig-param"><span class="n">n_trials_spont</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.run_one_intensity_save_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data of epochs and individal mice to a npz file.</p>
<p>by running over all mice of one group and one intensity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pre_direct</strong> (<em>str</em>) – path to rooot directory</p></li>
<li><p><strong>scale_pix_to_cm</strong> (<em>float</em>) – SCaling coefficient for converting pixels to cm.</p></li>
<li><p><strong>mouse_type</strong> (<em>str</em>) – mouse type such as <cite>FoxP2</cite> etc</p></li>
<li><p><strong>mouse_list</strong> (<em>list</em><em>(</em><em>int</em><em>)</em>) – list of mouse identification numbers</p></li>
<li><p><strong>folder</strong> (<em>str</em>) – the folder with the corresponding experiment protocol e.g. “Square_1_mW”.</p></li>
<li><p><strong>opto_par</strong> (<em>str</em>) – <cite>ChR2</cite> for ChR2 injected animals <cite>Control</cite> for Control group</p></li>
<li><p><strong>treadmil_velocity</strong> (<em>float</em>) – Treadmill velocity in <cite>cm/s</cite></p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>(</em><em>float</em><em>)</em>) – </p></li>
<li><p><strong>spont_trial_dict</strong> (<em>dict-like</em>) – <dl class="simple">
<dt>dict-like with values<span class="classifier">{‘max_distance’</span><span class="classifier">int(4.5*fps), # max #n_timebines between sampled epochs for spontaneous</span></dt><dd><p>’min_distance’ : int(3*fps), # min #n_timebines between sampled epochs for spontaneous
‘n_trials_spont’ : 25 # the average number of trials extracted from one spontaneous session}</p>
</dd>
</dl>
</p></li>
<li><p><strong>misdetection_dict</strong> (<em>dict-like</em>) – dictionary of constants used in the misdetection correction algorithm:</p></li>
<li><p><strong>intervals_dict</strong> (<em>dict-like</em>) – dictionary of intervals</p></li>
<li><p><strong>t_window_dict</strong> (<em>dict-like</em>) – dict-like containing information about time contants of the project:
t_window_dict = {<cite>fps</cite> : int, ‘n_timebin’ : int, ‘window_pos’ : int , ‘window_veloc’ : int}</p></li>
<li><p><strong>accep_interval_range</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>) – Smallest and largest acceptable trial sizes in timebins</p></li>
<li><p><strong>study_param_dict</strong> (<em>dictionray</em>) – dict-like of values regarding coordinate (x,y), body part (list of body parts) and plot parameter
(position, velocity, acceleration) packed from input of user</p></li>
<li><p><strong>max_distance</strong> (<em>int</em>) – maximum number of frames between sampled epochs for spontaneous</p></li>
<li><p><strong>min_distance</strong> (<em>int</em>) – mainimum number of frames between sampled epochs for spontaneous</p></li>
<li><p><strong>n_trials_spont</strong> (<em>int</em>) – number of spontaneous trials</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.save_npz">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">save_npz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pre_direct</span></em>, <em class="sig-param"><span class="n">mouse_type</span></em>, <em class="sig-param"><span class="n">opto_par</span></em>, <em class="sig-param"><span class="n">folder</span></em>, <em class="sig-param"><span class="n">pulse_inten</span></em>, <em class="sig-param"><span class="n">fps</span></em>, <em class="sig-param"><span class="n">window</span></em>, <em class="sig-param"><span class="n">n_timebin</span></em>, <em class="sig-param"><span class="n">file_name_ext</span></em>, <em class="sig-param"><span class="n">epochs_all_mice</span></em>, <em class="sig-param"><span class="n">epochs_mean_each_mouse</span></em>, <em class="sig-param"><span class="n">epochs_spont_all_mice</span></em>, <em class="sig-param"><span class="n">pre_info</span></em>, <em class="sig-param"><span class="n">cor</span></em>, <em class="sig-param"><span class="n">body_part</span></em>, <em class="sig-param"><span class="n">plot_param</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.save_npz" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the trial epochs in one .npz file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pre_direct</strong> (<em>str</em>) – path to rooot directory</p></li>
<li><p><strong>mouse_type</strong> (<em>str</em>) – mouse type such as ‘FoxP2’ or ..</p></li>
<li><p><strong>opto_par</strong> (<em>str</em>) – “ChR2” –&gt; for ChR2 injected animals
“Control” –&gt; for Control group</p></li>
<li><p><strong>folder</strong> (<em>str</em>) – the folder with the corresponding experiment protocol e.g. “Square_1_mW”.</p></li>
<li><p><strong>pulse_inten</strong> (<em>int</em>) – Pulse intensity in mW</p></li>
<li><p><strong>fps</strong> (<em>int</em>) – Frame per second</p></li>
<li><p><strong>window</strong> (<em>int</em>) – Moving average window for position</p></li>
<li><p><strong>n_timebin</strong> (<em>int</em>) – Number of frames to take derivative over</p></li>
<li><p><strong>file_name_ext</strong> (<em>str</em>) – File name extension</p></li>
<li><p><strong>epochs_all_mice</strong> (<em>2D-array</em><em>(</em><em>float</em><em>)</em>) – (pre | Laser ON | post) epochs with shape (n_trials, pre_interval+post_interval+interval+1)</p></li>
<li><p><strong>epochs_mean_each_mouse</strong> (<em>2D-array</em><em>(</em><em>float</em><em>)</em>) – average of (pre | Laser ON | post) epochs with shape (n_animals, 3)
averaged for individual animals</p></li>
<li><p><strong>epochs_spont_all_mice</strong> (<em>2D-array</em><em>(</em><em>float</em><em>)</em>) – (pre | Laser ON | post) spontaneous epochs with shape (n_trials, pre_interval+post_interval+interval+1)</p></li>
<li><p><strong>pre_info</strong> (<em>2D array</em><em>(</em><em>float</em><em>)</em>) – Three columns with averages of : pre_x , pre_v, pre_acceleration over pre_stim_interval duration.
with shape (n_trials, 3)</p></li>
<li><p><strong>cor_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – list of available coordinates e.g. ‘x’, ‘y’</p></li>
<li><p><strong>body_part_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – list of DLC labeled body parts</p></li>
<li><p><strong>plot_param_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – List of available parameters for analysis e.g position or velocity.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.save_npz_limb_and_tail">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">save_npz_limb_and_tail</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pre_direct</span></em>, <em class="sig-param"><span class="n">scale_pix_to_cm</span></em>, <em class="sig-param"><span class="n">mouse_type</span></em>, <em class="sig-param"><span class="n">mouse_list</span></em>, <em class="sig-param"><span class="n">folder</span></em>, <em class="sig-param"><span class="n">opto_par</span></em>, <em class="sig-param"><span class="n">misdetection_dict</span></em>, <em class="sig-param"><span class="n">pre_interval</span></em>, <em class="sig-param"><span class="n">interval</span></em>, <em class="sig-param"><span class="n">post_interval</span></em>, <em class="sig-param"><span class="n">t_window_dict</span></em>, <em class="sig-param"><span class="n">accep_interval_range</span></em>, <em class="sig-param"><span class="n">cor_list</span></em>, <em class="sig-param"><span class="n">body_part_list</span></em>, <em class="sig-param"><span class="n">plot_param_list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.save_npz_limb_and_tail" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data of epochs and individal mice to a npz file.</p>
<p>Run over all mice of one group and one intensity append epochs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pre_direct</strong> (<em>str</em>) – path to rooot directory</p></li>
<li><p><strong>scale_pix_to_cm</strong> (<em>float</em>) – Scaling coeficient for pixels to cm.</p></li>
<li><p><strong>mouse_type</strong> (<em>str</em>) – mouse type such as <cite>FoxP2</cite> or etc</p></li>
<li><p><strong>mouse_list</strong> (<em>list</em><em>(</em><em>int</em><em>)</em>) – list of mouse identification numbers</p></li>
<li><p><strong>folder</strong> (<em>str</em>) – the folder with the corresponding experiment protocol e.g. <cite>Square_1_mW</cite></p></li>
<li><p><strong>opto_par</strong> (<em>str</em>) – <cite>ChR2</cite> for ChR2 injected animals, <cite>Control</cite> for Control group</p></li>
<li><p><strong>misdetection_dict</strong> (<em>dict-like</em>) – dictionary of constants used in the misdetection correction algorithm</p></li>
<li><p><strong>pre_interval</strong> (<em>int</em>) – Number of time bins to be taken into account before laser onset</p></li>
<li><p><strong>interval</strong> (<em>int</em>) – Laser duration in timebins.</p></li>
<li><p><strong>post_interval</strong> (<em>int</em>) – Number of time bins to be taken into account after laser onset</p></li>
<li><p><strong>t_window_dict</strong> (<em>dict-like</em>) – dictionary containing information about time contants of the project</p></li>
<li><p><strong>accep_interval_range</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>) – Smallest and largest acceptable trial sizes in timebins</p></li>
<li><p><strong>cor_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – list of available coordinates e.g. <cite>x</cite>, <cite>y</cite></p></li>
<li><p><strong>body_part_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – list of DLC labeled body parts</p></li>
<li><p><strong>plot_param_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – List of available parameters for analysis e.g position or velocity</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.violin_plot_X_V_distiction">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">violin_plot_X_V_distiction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">result</span></em>, <em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">mouse_type</span></em>, <em class="sig-param"><span class="n">folder</span></em>, <em class="sig-param"><span class="n">fps</span></em>, <em class="sig-param"><span class="n">back_front_boundary</span></em>, <em class="sig-param"><span class="n">v_threshold</span></em>, <em class="sig-param"><span class="n">pre_stim_inter</span></em>, <em class="sig-param"><span class="n">ylim</span><span class="o">=</span><span class="default_value">[- 30, 30]</span></em>, <em class="sig-param"><span class="n">save_as_format</span><span class="o">=</span><span class="default_value">'.pdf'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.violin_plot_X_V_distiction" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot violin plots with columns for pre_laser distinction and hue for back and front distinction on the treadmill.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<em>dataframe</em>) – dataframe containing information of all animals</p></li>
<li><p><strong>path</strong> (<em>str</em>) – Path to save the figure</p></li>
<li><p><strong>folder</strong> (<em>str</em>) – Folder containing the experiment sessions</p></li>
<li><p><strong>back_front_boundary</strong> (<em>float</em>) – Threshold to set the position of the animal before the laser onset as either ‘back’ or ‘front’</p></li>
<li><p><strong>v_threshold</strong> (<em>float</em>) – Threshold to set the velocity of the animal before the laser onset as either ‘pos’ or ‘neg’</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – Y axis limits for the figure, default set to [-30,30]</p></li>
<li><p><strong>save_as_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Format to save the figure default is ‘.pdf’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Locomotion.violin_plot_summary">
<code class="sig-prename descclassname">Locomotion.</code><code class="sig-name descname">violin_plot_summary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_init</span></em>, <em class="sig-param"><span class="n">names</span></em>, <em class="sig-param"><span class="n">measure</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.violin_plot_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>plot violin plot for different columns in data</p>
</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Locomotion</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Locomotion_task.html"
                        title="next chapter">Locomotion Task Analysis</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/Projects/Locomotion/Code_doc_Locomotion.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Locomotion_task.html" title="Locomotion Task Analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Locomotion"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Behavioral Analysis 0.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Locomotion</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Locomotion Code Doc</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Shiva A. Lindi.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.2.
    </div>
  </body>
</html>