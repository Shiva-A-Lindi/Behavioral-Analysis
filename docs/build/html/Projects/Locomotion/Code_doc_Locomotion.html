<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Locomotion Code Doc &mdash; Behavioral Analysis 0.0.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Locomotion Task Analysis" href="Locomotion_task.html" />
    <link rel="prev" title="Locomotion" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Behavioral Analysis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Locomotion</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Locomotion Code Doc</a></li>
<li class="toctree-l2"><a class="reference internal" href="Locomotion_task.html">Locomotion Task Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Locomotion_task.html#file-hierarchy">File hierarchy</a></li>
<li class="toctree-l3"><a class="reference internal" href="Locomotion_task.html#jupyter-notebook">Jupyter notebook</a></li>
<li class="toctree-l3"><a class="reference internal" href="Locomotion_task.html#data-analysis">Data analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="Locomotion_task.html#misdetection-correction">Misdetection correction</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Lever%20Reaching/index.html">Lever Reaching</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Lever%20Reaching/Code_doc_Lever_Reaching.html">Lever Reaching Code Doc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lever%20Reaching/LED_detection.html">LED detection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Lever%20Reaching/LED_detection.html#classes">Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Lever%20Reaching/LED_detection.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Lever%20Reaching/Lever_reaching.html">Lever Reaching Task Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Lever%20Reaching/Lever_reaching.html#file-hierarchy">File hierarchy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Lever%20Reaching/Lever_reaching.html#experiment">Experiment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Lever%20Reaching/Lever_reaching.html#config-file">Config file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Lever%20Reaching/Lever_reaching.html#measures">Measures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Lever%20Reaching/Lever_reaching.html#misdetection-correction">Misdetection Correction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Lever%20Reaching/Lever_reaching.html#metadata">Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Lever%20Reaching/Lever_reaching.html#jupyter-notebook-and-data-analysis">Jupyter Notebook and Data Analysis</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Laser%20Detection/index.html">Laser Detection</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../DeepLabCut/index.html">DeepLabCut</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../DeepLabCut/DLC_installation.html">Guide to DeepLabCut installation on Windows 10</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../DeepLabCut/DLC_installation.html#nvidia-driver-installation">1. Nvidia Driver installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../DeepLabCut/DLC_installation.html#cuda-toolkit-installation">2. CUDA Toolkit installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../DeepLabCut/DLC_installation.html#visual-studio-installation">2.1 Visual Studio installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../DeepLabCut/DLC_installation.html#cuda-installation">2.2 CUDA installation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../DeepLabCut/DLC_installation.html#cudnn-installation">3. cuDNN installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../DeepLabCut/DLC_installation.html#tensorflow-installation">4. Tensorflow installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../DeepLabCut/DLC_installation.html#create-virtual-environment">4.1 Create virtual environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../DeepLabCut/DLC_installation.html#activate-the-environment">4.2 activate the environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../DeepLabCut/DLC_installation.html#install-tensorflow">4.3 install Tensorflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../DeepLabCut/DLC_installation.html#check-tensorflow-installation">4.4 check Tensorflow installation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../DeepLabCut/DLC_installation.html#deeplabcut-and-wxpython-installation">5. Deeplabcut and wxpython installation</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Behavioral Analysis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Locomotion</a> &raquo;</li>
      <li>Locomotion Code Doc</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Projects/Locomotion/Code_doc_Locomotion.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-Locomotion">
<span id="locomotion-code-doc"></span><h1>Locomotion Code Doc<a class="headerlink" href="#module-Locomotion" title="Permalink to this headline"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.MWW_test">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">MWW_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result_Ctr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'STN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Vglut2D2'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.MWW_test" title="Permalink to this definition"></a></dt>
<dd><p>Return two-sided Mann-Whitney test for ON-laser period velocity between Ctr and ChR2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<em>df</em>) – a data frame containing mean velocity for ChR2 mice.</p></li>
<li><p><strong>result_Ctr</strong> (<em>df</em>) – a data frame containing mean velocity for Control mice.</p></li>
<li><p><strong>mouse_type</strong> (<em>str</em>) – mouse type as a string e.g. FoxP2, D2, Vglut2 ..</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>stat</strong> – MWW stat results</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.align_right_left">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">align_right_left</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.align_right_left" title="Permalink to this definition"></a></dt>
<dd><p>Correct if for any reason there has been a shift between labelings of right and left side</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>right</strong> (<em>1-D array</em>) – position in time detected from the right camera</p></li>
<li><p><strong>left</strong> (<em>1-D array</em>) – position in time detected from the left camera</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.annotate_conditions">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">annotate_conditions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.annotate_conditions" title="Permalink to this definition"></a></dt>
<dd><p>write grouping condition for each double column of “ON”-“OFF”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>obj</em>) – plot axis.</p></li>
<li><p><strong>y</strong> (<em>float</em>) – y axes-fraction of the text.</p></li>
<li><p><strong>conditions</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – conditions corresponding to each double column</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.annotate_n_trials">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">annotate_n_trials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">txt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'N</span> <span class="pre">=</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.annotate_n_trials" title="Permalink to this definition"></a></dt>
<dd><p>Annotate the number of trials for the provided key within the <cite>n_dict</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>Axesplot</em>) – matplotlib axis.</p></li>
<li><p><strong>n_dict</strong> (<em>dict-like</em>) – dictionary of number of trials.</p></li>
<li><p><strong>key</strong> (<em>str</em><em>, or </em><em>tuple</em>) – key for which the number needs to be retrieved.</p></li>
<li><p><strong>xy</strong> (<em>tuple</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – x and y coordinate of the text annotated in axes fraction. The default is (0.5, 0.1).</p></li>
<li><p><strong>txt</strong> (<em>str</em><em>, </em><em>optional</em>) – Text informing about the number. The default is ‘N = ‘.</p></li>
<li><p><strong>fontsize</strong> (<em>float</em><em>, </em><em>optional</em>) – fontsize of text. The default is 20.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>exists</strong> – Returns <cite>True</cite> if the key exists and <cite>False</cite> otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.annotate_n_trials_all_conditions">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">annotate_n_trials_all_conditions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_trials_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.annotate_n_trials_all_conditions" title="Permalink to this definition"></a></dt>
<dd><p>write number of trials for each double column of “ON”-“OFF”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>obj</em>) – plot axis.</p></li>
<li><p><strong>n_trials_dict</strong> (<em>dict</em>) – dictionary with values as number of trials and keys as condition of the column.</p></li>
<li><p><strong>y</strong> (<em>float</em>) – y axes-fraction of the text.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.average_position_r_l">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">average_position_r_l</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">misdetection_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body_part</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_param</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.average_position_r_l" title="Permalink to this definition"></a></dt>
<dd><p>Return three-level correction of the average between right and left side for multiple selected body-parts.</p>
<p>Extract the right and left trace for each selected body part, correct right and left traces with
“compare_r_l_correct_misdetect”, then average over right and left and remove jitters by calling
“correct_labeling_jitter”. Then return the moving average of all selected body-parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>dataframe</em>) – Dataframe derived from DLC for one session of one animal</p></li>
<li><p><strong>window</strong> (<em>int</em>) – Moving average window for smoothing the position time series</p></li>
<li><p><strong>misdetection_dict</strong> (<em>dict-like</em>) – dict-like containing constants for misdetection corrections</p></li>
<li><p><strong>cor</strong> (<em>str</em>) – Which coordinate to work with. e.g. ‘x’ or ‘y’</p></li>
<li><p><strong>body_part</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – Which body parts to average over.</p></li>
<li><p><strong>plot_param</strong> (<em>str</em>) – Parameter for analysis e.g. position or velocity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>corrected_averaged</strong> – Moving average of all selected body-parts.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1-D array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.categorize_pre_x_and_v">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">categorize_pre_x_and_v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back_front_boundary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_stim_inter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.categorize_pre_x_and_v" title="Permalink to this definition"></a></dt>
<dd><p>Set threshold to velocity and x position averaged over pre_stim_inter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<em>dataframe</em>) – dataframe containing information of all animals</p></li>
<li><p><strong>back_front_boundary</strong> (<em>float</em>) – Threshold to set the position of the animal before the laser onset as either ‘back’ or ‘front’</p></li>
<li><p><strong>v_threshold</strong> (<em>float</em>) – Threshold to set the velocity of the animal before the laser onset as either ‘pos’ or ‘neg’</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – the dataframe as the input but with the difference that pre_X_front_back and
pre_velocity_sign set to binary(str) values accorfing to values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.check_DLC_corresponds_to_laser">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">check_DLC_corresponds_to_laser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath_laser</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath_DLC</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.check_DLC_corresponds_to_laser" title="Permalink to this definition"></a></dt>
<dd><p>Return true if the filename except for the last elemet is the same
between the DLC and the laser files.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.choose_n_from_colormap">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">choose_n_from_colormap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.choose_n_from_colormap" title="Permalink to this definition"></a></dt>
<dd><p>Return ‘n’ equally distanced colors from the colormap</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.compare_analysis_file">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">compare_analysis_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.compare_analysis_file" title="Permalink to this definition"></a></dt>
<dd><p>match experiment analysis filenames between two directories and report comparison</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.compare_r_l_correct_misdetect">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">compare_r_l_correct_misdetect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">right_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc_deviance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">internal_ctr_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percent_thresh_align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter_jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.compare_r_l_correct_misdetect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Compare the right and left sides and correct if the difference between</dt><dd><p>the two is more than an acceptable amount.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>right_p</strong> (<em>1-D array</em>) – Position in time detected from the right camera</p></li>
<li><p><strong>left_p</strong> (<em>1-D array</em>) – Position in time detected from the left camera</p></li>
<li><p><strong>acc_deviance</strong> (<em>float</em>) – Passed within misdetect dict-like. Acceptable deviance of the right and left side detections</p></li>
<li><p><strong>t_s</strong> (<em>int</em>) – The number of procedeeing and post time bins to average from and correct the misdetection with</p></li>
<li><p><strong>internal_ctr_dev</strong> (<em>float</em>) – The threshold (cm) by which it is allowed for left and right detections to differ.</p></li>
<li><p><strong>percent_thresh_align</strong> (<em>int</em>) – The percentage above which it’s decided that there is a systematic shift between the right and left side detections.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>right</strong> (<em>1-D array</em>) – Corrected position in time detected from the right camera</p></li>
<li><p><strong>left</strong> (<em>1-D array</em>) – Corrected position in time detected from the left camera</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.convert_all_xlsx_to_csv">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">convert_all_xlsx_to_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.convert_all_xlsx_to_csv" title="Permalink to this definition"></a></dt>
<dd><p>conver all xlsx files to csvs
under the given path</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.convert_csv_to_xlsx">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">convert_csv_to_xlsx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.convert_csv_to_xlsx" title="Permalink to this definition"></a></dt>
<dd><p>Check if a .xlsx version of all the .csv files exists,
if not convert to this format
and remove the .csv to save space</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.correct_accep_interval_range_for_beta">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">correct_accep_interval_range_for_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">accep_interval_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.correct_accep_interval_range_for_beta" title="Permalink to this definition"></a></dt>
<dd><p>beta stimulation doesn’t include the last half cycle so
it’s shorter. Therefore the acceptable range is coorected to be
smaller</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.correct_labeling_jitter">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">correct_labeling_jitter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter_jitter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc_deviance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">internal_ctr_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percent_thresh_align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.correct_labeling_jitter" title="Permalink to this definition"></a></dt>
<dd><p>Correct the detections exceeding the max speed of the mouse.</p>
<p>The detected jitters are replaced by the average of before and after time stamps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>1-D array</em>) – The time series that needs correction (usually the average of right and left cameras).</p></li>
<li><p><strong>jitter_threshold</strong> (<em>float</em>) – The allowed maximum movement in one timebin with the max allowed velocity.</p></li>
<li><p><strong>n_iter_jitter</strong> (<em>int</em>) – Number of times to repeat the correction algorithm.</p></li>
<li><p><strong>t_s</strong> (<em>int</em>) – The number of timebins to average from when correcting the jitter point.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x</strong> – The corrected time series.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1-D array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.create_colormaps_for_beta_square_pulses">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">create_colormaps_for_beta_square_pulses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['Oranges_r',</span> <span class="pre">'Blues']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">square</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['Reds_r',</span> <span class="pre">'Greens']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.create_colormaps_for_beta_square_pulses" title="Permalink to this definition"></a></dt>
<dd><p>create colormaps for square and beta stimulations by creating a
spectrum between the two given colors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beta</strong> (<em>list</em><em>(</em><em>str</em><em>)</em><em>, </em><em>optional</em>) – colormaps to be joined representing beta stimulations. The default is [‘Oranges_r’, ‘Blues’].</p></li>
<li><p><strong>square</strong> (<em>list</em><em>(</em><em>str</em><em>)</em><em>, </em><em>optional</em>) – colormaps to be joined representing beta stimulations. The default is [‘Reds_r’, ‘Greens’].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>beta_cm</strong> (<em>obj</em>) – beta colormap.</p></li>
<li><p><strong>square_cm</strong> (<em>obj</em>) – square colormap.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.create_df_from_data_summary">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">create_df_from_data_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">summary_files_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ChR2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.create_df_from_data_summary" title="Permalink to this definition"></a></dt>
<dd><p>‘append the summary df of all files given in the list</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.create_mouse_color_dict">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">create_mouse_color_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mouse_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_color_opto_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.create_mouse_color_dict" title="Permalink to this definition"></a></dt>
<dd><p>Assign colors to each individual mouse in the mouse_dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mouse_dict</strong> (<em>dict</em>) – dictionary of mouse numbers for each mouse line and optogenetic expression.</p></li>
<li><p><strong>mouse_color_opto_dict</strong> (<em>dict</em>) – dictionary of color lists for the different optogenetic expressions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>mouse_color_dict</strong> – dictionary of colors for each mouse number in mouse_dict.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.create_pulse_specific_color_lists">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">create_pulse_specific_color_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pulse_cmap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.create_pulse_specific_color_lists" title="Permalink to this definition"></a></dt>
<dd><p>create color dict for different stimulation protocols</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.create_x_position_pairs">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">create_x_position_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.create_x_position_pairs" title="Permalink to this definition"></a></dt>
<dd><p>Create x pairs between pairs of x ticks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>axes.SubplotBase</em>) – The axes of the subplot..</p></li>
<li><p><strong>pad</strong> (<em>float</em><em>, </em><em>optional</em>) – distancing from the tick positions. The default is 0.2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x_series</strong> – array of pairs of x positions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D-array(float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.csv_from_excel">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">csv_from_excel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.csv_from_excel" title="Permalink to this definition"></a></dt>
<dd><p>Convert xlsx file to csv</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.delta_v_vs_laser_intensity">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">delta_v_vs_laser_intensity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pre_direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ChR2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'STR'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Vglut2D2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pulse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'beta'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.delta_v_vs_laser_intensity" title="Permalink to this definition"></a></dt>
<dd><p>extract the (means, std) of the changes from baseline to when laser-ON velocity
for different laser intensities. Note that this function requires sorted
file hierarchy.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.derivative">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">derivative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.derivative" title="Permalink to this definition"></a></dt>
<dd><p>Take the derivative over delta_t.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.derivative_mov_ave">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">derivative_mov_ave</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_veloc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.derivative_mov_ave" title="Permalink to this definition"></a></dt>
<dd><p>Take the derivative with delta_t and do a moving average.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.epochs_stats">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">epochs_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs_spont</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.epochs_stats" title="Permalink to this definition"></a></dt>
<dd><p>Return mean and confidence intervals of epochs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epochs</strong> (<em>2D array</em><em>(</em><em>float</em><em>)</em>) – Trials containtning laser stimulation aligned in rows. n_col = pre_interval + interval + post_interval</p></li>
<li><p><strong>epochs_spont</strong> (<em>2D array</em><em>(</em><em>float</em><em>)</em>) – same as epochs only for spontaneous sessions with no laser stimulation.</p></li>
<li><p><strong>Returns</strong> – </p></li>
<li><p><strong>--------</strong> – </p></li>
<li><p><strong>epochs_mean</strong> (<em>2D array</em><em>(</em><em>float</em><em>)</em>) – average of epochs for all trials (averaged over rows)</p></li>
<li><p><strong>epochs_mean_spont</strong> (<em>2D array</em><em>(</em><em>float</em><em>)</em>) – average of epochs_spont for all trials (averaged over rows)</p></li>
<li><p><strong>confidence_inter</strong> (<em>2D array</em><em>(</em><em>float</em><em>)</em>) – 95% confidence interval of epochs</p></li>
<li><p><strong>confidence_inter_spont</strong> (<em>2D array</em><em>(</em><em>float</em><em>)</em>) – 95% confidence interval of epochs_spont</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.extract_epochs">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">extract_epochs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smallest_accep_inter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">largest_accep_inter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session_length</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.extract_epochs" title="Permalink to this definition"></a></dt>
<dd><p>Extract the (pre | Laser ON | post) epochs.</p>
<p>Check reported (start,end) of trials from bins and discard trial with unacceptable duration.
Return the stacked the corresponding frames of all trials from the measurment array x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bins</strong> (<em>2D-array</em><em>(</em><em>int</em><em>)</em>) – array of start and end times for trials</p></li>
<li><p><strong>smallest_accep_inter</strong> (<em>int</em>) – Smallest acceptable duration of an interval in frames</p></li>
<li><p><strong>largest_accep_inter</strong> (<em>int</em>) – Largest acceptable duration of an interval in frames</p></li>
<li><p><strong>pre_interval</strong> (<em>int</em>) – Number of time bins to be taken into account before laser onset</p></li>
<li><p><strong>interval</strong> (<em>int</em>) – Laser duration in timebins.</p></li>
<li><p><strong>post_interval</strong> (<em>int</em>) – Number of time bins to be taken into account after laser onset</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>epochs</strong> (<em>2D array(float)</em>) – Trials containtning laser stimulation aligned in rows. n_col = pre_interval + interval + post_interval</p></li>
<li><p><strong>n_trials</strong> (<em>int</em>) – Number of trials</p></li>
<li><p><strong>take</strong> (<em>1D array(int)</em>) – Array of indices corresponding to pre | on | post epoch frmaes.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.extract_epochs_over_trials">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">extract_epochs_over_trials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">files_list_DLC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">files_list_laser</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_pix_to_cm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accep_interval_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_treadmill_velocity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spont_trial_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">misdetection_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study_param_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_stim_inter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_timebin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_veloc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spont</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.extract_epochs_over_trials" title="Permalink to this definition"></a></dt>
<dd><p>Return all the epochs of all similar trials for one mouse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>files_list_DLC</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – List of paths to all DLC .csv files for sessions</p></li>
<li><p><strong>files_list_laser</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – List of paths to all .csv files that have (start,end) laser times.</p></li>
<li><p><strong>direct</strong> (<em>str</em>) – Path to the parent directory containing all stim_types</p></li>
<li><p><strong>stim_loc</strong> (<em>str</em>) – the folder with the corresponding experiment brain location e.g. “STR”.</p></li>
<li><p><strong>stim_type</strong> (<em>str</em>) – folder containing sessions for this particular protocol</p></li>
<li><p><strong>scale_pix_to_cm</strong> (<em>float</em>) – Scaling coefficient converting pixels to cm</p></li>
<li><p><strong>spont</strong> (<em>str</em>) – Either False –&gt; for trials containing laser stimulation
or ‘y’ –&gt; for spontaneous trials with no laser</p></li>
<li><p><strong>accep_interval_range</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>) – Smallest and largest acceptable trial sizes in timebins</p></li>
<li><p><strong>spont_trial_dict</strong> (<em>dict-like</em>) – {‘max_distance’ : int (max n_timebins between sampled epochs for spontaneous),
‘min_distance’ : int (min #n_timebines between sampled epochs for spontaneous),
‘n_trials_spont’ : int (the average number of trials extracted from one spontaneous session)}</p></li>
<li><p><strong>misdetection_dict</strong> (<em>dict-like</em>) – Dictionary of constants used in the misdetection correction algorithm:
{‘acc_deviance’ : float  (acceptable deviance between right and left detections),
‘internal_ctr_dev’ : float,
‘percent_thresh_align’ : int,
‘t_s’ : int (number of time steps before and after to look at),
‘n_iter_jitter’ : int (how many times go over data to find jitters and clear them out),
‘jitter_threshold’ : int (max_speed/fps)}</p></li>
<li><p><strong>study_param_dict</strong> (<em>dict-like</em>) – Dictionary of values regarding coordinate (x,y), body part (list of body parts) and plot parameter
(position, velocity, acceleration) packed from input of user</p></li>
<li><p><strong>pre_interval</strong> (<em>int</em>) – Number of time bins to be taken into account before laser onset</p></li>
<li><p><strong>interval</strong> (<em>int</em>) – Laser duration in timebins.</p></li>
<li><p><strong>post_interval</strong> (<em>int</em>) – Number of time bins to be taken into account after laser onset</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
<li><p><strong>fps</strong> (<em>int</em>) – Frame per second of the video</p></li>
<li><p><strong>n_timebin</strong> (<em>int</em>) – Number of frames as timebins for the x derivative to yields velocity</p></li>
<li><p><strong>window_veloc</strong> (<em>int</em>) – Velocity moving average window in frames</p></li>
<li><p><strong>window_pos</strong> (<em>int</em>) – Position moving average window in frames</p></li>
<li><p><strong>n_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples to extract from one spontaneous session. Only necessary for spont = ‘y’ cases.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>epochs</strong> (<em>2D array(float)</em>) – (pre | Laser ON | post) epochs with shape (n_trials, pre_interval+post_interval+interval+1)</p></li>
<li><p><strong>pre_info</strong> (<em>2D array(float)</em>) – Three columns with averages of : pre_x , pre_v, pre_acceleration over pre_stim_interval duration.
with shape (n_trials, 3)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.extract_epochs_over_trials_one_side_one_body_part">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">extract_epochs_over_trials_one_side_one_body_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">files_list_DLC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">files_list_Laser</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_pix_to_cm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accep_interval_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treadmill_velocity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">misdetection_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_timebin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_veloc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body_part</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_or_right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'right'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.extract_epochs_over_trials_one_side_one_body_part" title="Permalink to this definition"></a></dt>
<dd><p>Return all the epochs of all simillar trials for one mouse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>files_list_DLC</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – List of paths to all DLC .csv files for sessions</p></li>
<li><p><strong>files_list_laser</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – List of paths to all .csv files that have (start,end) laser times.</p></li>
<li><p><strong>direct</strong> (<em>str</em>) – Path to the parent directory containing all stim_types</p></li>
<li><p><strong>stim_loc</strong> (<em>str</em>) – the folder with the corresponding experiment brain location e.g. “STR”.</p></li>
<li><p><strong>stim_type</strong> (<em>str</em>) – Folder containing sessions for this protocol</p></li>
<li><p><strong>scale_pix_to_cm</strong> (<em>float</em>) – </p></li>
<li><p><strong>accep_interval_range</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>) – Smallest and largest acceptable trial sizes in timebins</p></li>
<li><p><strong>misdetection_dict</strong> (<em>dict-like</em>) – dictionary of constants used in the misdetection correction algorithm:
{‘acc_deviance’ : float  (acceptable deviance between right and left detections),
‘internal_ctr_dev’ : float,
‘percent_thresh_align’ : int,
‘t_s’ : int (number of time steps before and after to look at),
‘n_iter_jitter’ : int (how many times go over data to find jitters and clear them out),
‘jitter_threshold’ : int (max_speed/fps)}</p></li>
<li><p><strong>pre_interval</strong> (<em>int</em>) – Number of time bins to be taken into account before laser onset</p></li>
<li><p><strong>interval</strong> (<em>int</em>) – Laser duration in timebins.</p></li>
<li><p><strong>post_interval</strong> (<em>int</em>) – Number of time bins to be taken into account after laser onset</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
<li><p><strong>fps</strong> (<em>int</em>) – Frame per second of the video</p></li>
<li><p><strong>n_timebin</strong> (<em>int</em>) – Number of frames as timebins for the x derivative to yields velocity</p></li>
<li><p><strong>window_veloc</strong> (<em>int</em>) – Velocity moving average window in frames</p></li>
<li><p><strong>window_pos</strong> (<em>int</em>) – Position moving average window in frames</p></li>
<li><p><strong>left_or_right</strong> (<em>str</em><em>, </em><em>optional</em>) – Either left side or right side. Default value is set to ‘right’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>epochs</strong> – (pre | Laser ON | post) epochs with shape (n_trials, pre_interval+post_interval+interval+1)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D-array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.extract_info_from_npz_filename">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">extract_info_from_npz_filename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.extract_info_from_npz_filename" title="Permalink to this definition"></a></dt>
<dd><p>extract info about experiment from the summary npz file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.extract_info_from_saved_data">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">extract_info_from_saved_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ChR2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.extract_info_from_saved_data" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>for the given filename extract information from filename and create the mean velocity pre/post laser</dt><dd><p>in a dataframe</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – DESCRIPTION.</p></li>
<li><p><strong>intervals_dict</strong> (<em>dict-like</em>) – <dl class="simple">
<dt>dict-like of interals:{‘pre_interval’<span class="classifier">int(.5*fps), # interval before laser onset</span></dt><dd><p>’interval’ : int(interval_in_sec * fps), # number of timebins of stimulation
‘post_interval’ : int(.5*fps*2), # interval after laser onset
‘pre_stim_inter’ : pre_stim_inter }</p>
</dd>
</dl>
</p></li>
<li><p><strong>opto_par</strong> (<em>str</em><em>, </em><em>optional</em>) – e.g. ChR2 or Control. The default is ‘ChR2’.</p></li>
<li><p><strong>report_stats</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether report the statistical tests. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>df</strong> (<em>dataframe</em>) – dataframe summerizing all data.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – information about the file extracted from its name.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.extract_pre_laser_x_epochs_over_trials">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">extract_pre_laser_x_epochs_over_trials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">files_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">files_list_laser</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_pix_to_cm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">misdetection_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smallest_accep_inter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">largest_accep_inter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_stim_inter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.extract_pre_laser_x_epochs_over_trials" title="Permalink to this definition"></a></dt>
<dd><p>Return all the x positions in epochs preceding to a ON-laser of all trials for one mouse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>files_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – List of the file names of the sessions</p></li>
<li><p><strong>files_list_laser</strong> – List of file names for laser detections</p></li>
<li><p><strong>pre_direct</strong> (<em>str</em>) – Path to the root directory of the project</p></li>
<li><p><strong>stim_loc</strong> (<em>str</em>) – the folder with the corresponding experiment brain location e.g. “STR”.</p></li>
<li><p><strong>stim_type</strong> (<em>str</em>) – Folder containing this specific protocol.</p></li>
<li><p><strong>scale_pix_to_cm</strong> (<em>float</em>) – Scaling coeficient for pixels to cm.</p></li>
<li><p><strong>window_pos</strong> (<em>int</em>) – Moving average window for position</p></li>
<li><p><strong>misdetection_dict</strong> (<em>dict-like</em>) – dict-like containing constants for misdetection corrections</p></li>
<li><p><strong>smallest_accep_inter</strong> (<em>int</em>) – Smallest acceptable duration of an interval in frames</p></li>
<li><p><strong>largest_accep_inter</strong> (<em>int</em>) – Largest acceptable duration of an interval in frames</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>epochs</strong> – X positions prior to laser stimulation aligned in rows. n_col = pre_stim_inter</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D array(float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.filter_based_on_substring">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">filter_based_on_substring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">not_contains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.filter_based_on_substring" title="Permalink to this definition"></a></dt>
<dd><p>keep only strings that include the all the given substrings in contains</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.find_filepaths_for_stim_type_and_loc_list">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">find_filepaths_for_stim_type_and_loc_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stim_loc_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.find_filepaths_for_stim_type_and_loc_list" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stim_loc_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – stimulation locaiton list.</p></li>
<li><p><strong>pre_direct</strong> (<em>str</em>) – path to the project root.</p></li>
<li><p><strong>stim_type_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – stimulation type (pulse + intesity) list.</p></li>
<li><p><strong>opto_par</strong> (<em>str</em>) – optogenetic expression.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>summary_files_list</strong> – list of file paths satisfying the input arguments.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.find_filepaths_of_corresponding_stim_loc_for_mouse_type">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">find_filepaths_of_corresponding_stim_loc_for_mouse_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pre_direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_type_to_loc_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.find_filepaths_of_corresponding_stim_loc_for_mouse_type" title="Permalink to this definition"></a></dt>
<dd><p>Find filepaths of the summary files with corresponding stim type –&gt; stim_loc –&gt; mouse_type
charecterestics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pre_direct</strong> (<em>str</em>) – path to project root.</p></li>
<li><p><strong>opto_par</strong> (<em>{'ChR2'</em><em>, </em><em>'Control'}</em>) – optogenetic expression.</p></li>
<li><p><strong>stim_type_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – stim type protocol.</p></li>
<li><p><strong>mouse_type_to_loc_dict</strong> (<em>dict-like</em>) – dictionary coupling mouse type to the desired stim location.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>summary_files_list</strong> – filepaths.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.find_files_containing_substring">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">find_files_containing_substring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">substring</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.find_files_containing_substring" title="Permalink to this definition"></a></dt>
<dd><p>Walk in all subfolders and return all files containing
substring.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – path to lood under for files.</p></li>
<li><p><strong>substring</strong> (<em>str</em>) – substring that is required to be contained in path.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>files</strong> – list of files under path containing substring.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.find_header_line_laser_file_csv">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">find_header_line_laser_file_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.find_header_line_laser_file_csv" title="Permalink to this definition"></a></dt>
<dd><p>Find which line includes the headers of ‘ON’ and ‘OFF in the csv file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.find_header_line_laser_file_excel">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">find_header_line_laser_file_excel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.find_header_line_laser_file_excel" title="Permalink to this definition"></a></dt>
<dd><p>Find which line includes the headers of ‘ON’ and ‘OFF in the excel file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.find_mouse_no">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">find_mouse_no</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.find_mouse_no" title="Permalink to this definition"></a></dt>
<dd><p>extract the  mouse number based on filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filepath</strong> (<em>str</em>) – path of the DLC file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>mouse_no</strong> – mouse number.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.find_session_day_tag">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">find_session_day_tag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.find_session_day_tag" title="Permalink to this definition"></a></dt>
<dd><p>extract the session tag that is e.g. [a, b, …][01, 02, ..] based on filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filepath</strong> (<em>str</em>) – path of the DLC file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>day tag</strong> – 3 charecter tag assigned to one session of recording.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.find_treadmill_velocity">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">find_treadmill_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.find_treadmill_velocity" title="Permalink to this definition"></a></dt>
<dd><p>Determine the treadmill velocity based on filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filepath</strong> (<em>str</em>) – path of the DLC file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>treadmill_velocity</strong> – The treadmill velocity in cm/s. If not specified in filename, default = 15 is returned.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.flatten">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">flatten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.flatten" title="Permalink to this definition"></a></dt>
<dd><p>create a flattened list of the list of lists</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.get_DLC_files">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">get_DLC_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.get_DLC_files" title="Permalink to this definition"></a></dt>
<dd><p>Find DLC files</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.get_extension">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">get_extension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.get_extension" title="Permalink to this definition"></a></dt>
<dd><p>return file extension from path</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.get_input_cor_body_part">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">get_input_cor_body_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cor_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body_part_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_param_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.get_input_cor_body_part" title="Permalink to this definition"></a></dt>
<dd><p>Ask for the body part and coordinate from user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cor_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – list of available coordinates e.g. ‘x’, ‘y’</p></li>
<li><p><strong>body_part_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – list of DLC labeled body parts</p></li>
<li><p><strong>plot_param_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – List of available parameters for analysis e.g position or velocity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>study_param_dict</strong> – selected items from the options in the inputs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.get_laser_files">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">get_laser_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.get_laser_files" title="Permalink to this definition"></a></dt>
<dd><p>Find laser files</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.get_name">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">get_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.get_name" title="Permalink to this definition"></a></dt>
<dd><p>Return filename from path</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.get_nested_keys">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">get_nested_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictionary</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.get_nested_keys" title="Permalink to this definition"></a></dt>
<dd><p>Return the set of the keys of the dictionaries that are nested
whithin the original dictionary</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.get_pulse_list">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">get_pulse_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">protocol_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ChR2'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.get_pulse_list" title="Permalink to this definition"></a></dt>
<dd><p>get the list of all pulse types from the protocol dict
for the specified mouse line</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.get_set_of_sorted">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">get_set_of_sorted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.get_set_of_sorted" title="Permalink to this definition"></a></dt>
<dd><p>get set of dict values
sort them and put back in dict</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.get_sorted_laser_DLC_files">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">get_sorted_laser_DLC_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.get_sorted_laser_DLC_files" title="Permalink to this definition"></a></dt>
<dd><p>print sorted files in laser and DLC folders to
see if the match</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.handle_legend_label">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">handle_legend_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body_part</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotate_n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.handle_legend_label" title="Permalink to this definition"></a></dt>
<dd><p>Create the legend label based on the input parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>object</em>) – plot axis.</p></li>
<li><p><strong>label</strong> (<em>str</em>) – Determining the variable to be reported as legend.</p></li>
<li><p><strong>stim_type</strong> (<em>str</em>) – stimulation type and string joined with underscore.</p></li>
<li><p><strong>body_part</strong> (<em>list</em><em> (</em><em>str</em><em>)</em>) – list of tracked  body parts.</p></li>
<li><p><strong>epochs</strong> (<em>nd-array</em><em> (</em><em>float</em><em>)</em>) – time epochs of all trials.</p></li>
<li><p><strong>annotate_n</strong> (<em>bool</em>) – if True is True the number of trials is written as text in the plot
otherwise it will be reported in the legend.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>ax</strong> (<em>object</em>) – plot axis.</p></li>
<li><p><strong>label</strong> (<em>TYPE</em>) – text to be put in the plot object.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.input_plot">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">input_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">laser_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_no</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_no</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_window_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">misdetection_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.pdf'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.input_plot" title="Permalink to this definition"></a></dt>
<dd><p>Get the specifics of the plot as input and call the corresponding plot function to plot the session.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>Dataframe</em>) – Dataframe derived from DLC for one session of one animal</p></li>
<li><p><strong>laser_t</strong> (<em>Dataframe</em>) – Dataframe with laser onset and offset times as columns</p></li>
<li><p><strong>mouse_type</strong> (<em>str</em>) – Mouse type. For example <cite>FoxP2</cite></p></li>
<li><p><strong>mouse_no</strong> (<em>int</em>) – Mouse number</p></li>
<li><p><strong>trial_no</strong> (<em>int</em>) – Trial number specified in file name</p></li>
<li><p><strong>opto_par</strong> (<em>str</em>) – Optogenetic specification. For example <cite>ChR2</cite> or <cite>Control</cite></p></li>
<li><p><strong>pre_direct</strong> (<em>str</em>) – Path to the root directory of the project</p></li>
<li><p><strong>exp_dict</strong> (<em>dict-like</em>) – Experiment dictionary for cor_list, body_part_list and plot_param_list</p></li>
<li><p><strong>t_window_dict</strong> (<em>dict-like</em>) – Dictionary of time constants</p></li>
<li><p><strong>misdetection_dict</strong> (<em>dict-like</em>) – Dictionary for misdetection algorithm constants</p></li>
<li><p><strong>save_as_format</strong> (<em>str</em><em>, </em><em>optional</em>) – The extension of the saved figure</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.keep_corresponding_stim_loc_for_mouse_type">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">keep_corresponding_stim_loc_for_mouse_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">summary_files_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_type_to_loc_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.keep_corresponding_stim_loc_for_mouse_type" title="Permalink to this definition"></a></dt>
<dd><p>from the provided list of files only keep ones that correspond to the specified mouse_type –&gt; stim_loc
coupling in the dictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>summary_files_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – filepaths.</p></li>
<li><p><strong>mouse_type_to_loc_dict</strong> (<em>dict-like</em>) – dictionary coupling mouse type to the desired stim location .</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>summary_files_list</strong> – filepaths.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.lighten_color">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">lighten_color</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">color</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amount</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.lighten_color" title="Permalink to this definition"></a></dt>
<dd><p>Lightens the given color by multiplying (1-luminosity) by the given amount.
Input can be matplotlib color string, hex string, or RGB tuple.</p>
<p>Examples:
&gt;&gt; lighten_color(‘g’, 0.3)
&gt;&gt; lighten_color(‘#F034A3’, 0.6)
&gt;&gt; lighten_color((.3,.55,.1), 0.5)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.list_all_files">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">list_all_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extensions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['.xlsx',</span> <span class="pre">'.csv']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.list_all_files" title="Permalink to this definition"></a></dt>
<dd><p>List all the files with this extention in this directory</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.min_and_mean_on_off">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">min_and_mean_on_off</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_stim_inter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.min_and_mean_on_off" title="Permalink to this definition"></a></dt>
<dd><p>Report the min or mean (specified by measure) velocity in the off-on periods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epochs</strong> (<em>2D array</em><em>(</em><em>float</em><em>)</em>) – Trial variables in rows. n_col = pre_interval + interval + post_interval</p></li>
<li><p><strong>measure</strong> (<em>str</em>) – ‘mean’ or ‘min’</p></li>
<li><p><strong>pre_interval</strong> (<em>int</em>) – Number of time bins to be taken into account before laser onset</p></li>
<li><p><strong>interval</strong> (<em>int</em>) – Laser duration in timebins.</p></li>
<li><p><strong>post_interval</strong> (<em>int</em>) – Number of time bins to be taken into account after laser onset</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Unpacked in dict-like. Not used here.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>average_of_off_on_off</strong> – array of 3 columns. first column is the aversge of pre-intevsl,
second the ‘measure’ during laser interval
third again the average of post</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.min_velocity_diff_inten_box_plot">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">min_velocity_diff_inten_box_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_x_v_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-</span> <span class="pre">40,</span> <span class="pre">15]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.pdf'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.min_velocity_diff_inten_box_plot" title="Permalink to this definition"></a></dt>
<dd><p>Compare min velocity during laser for trials with positive and negative pre laser velocity.</p>
<p>Box plots to show this comparison for different intensity in same animal types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – list of paths to .npz files</p></li>
<li><p><strong>path_to_save</strong> (<em>str</em>) – Path to save figure</p></li>
<li><p><strong>intervals_dict</strong> (<em>dict-like</em>) – <dl class="simple">
<dt>dict-like of interals:{‘pre_interval’<span class="classifier">int(.5*fps), # interval before laser onset</span></dt><dd><p>’interval’ : int(interval_in_sec * fps), # number of timebins of stimulation
‘post_interval’ : int(.5*fps*2), # interval after laser onset
‘pre_stim_inter’ : pre_stim_inter }</p>
</dd>
</dl>
</p></li>
<li><p><strong>pre_x_v_dict</strong> (<em>dict-like</em>) – <dl class="simple">
<dt>{‘back_front_boundary’<span class="classifier">(treadmill_len-elec_shock)/2, # set the limit below which is considered back of the treadmill</span></dt><dd><p>’v_threshold’ : 0,
‘pre_stim_inter’ : pre_stim_inter # number of timebins in the pre-stimulus period}</p>
</dd>
</dl>
</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – y axis limits for figure. Default is set to [-40,15]</p></li>
<li><p><strong>save_as_format</strong> (<em>str</em><em>, </em><em>optional</em>) – format to save the figure. Default is set to ‘.pdf’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.min_velocity_mouse_type_box_plot">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">min_velocity_mouse_type_box_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_x_v_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-</span> <span class="pre">40,</span> <span class="pre">15]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.pdf'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.min_velocity_mouse_type_box_plot" title="Permalink to this definition"></a></dt>
<dd><p>Compare min velocity during laser.</p>
<p>Box plots to show this comparison FOR trials with positive and negative
pre laser velocity for same intensity in different animal types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – list of paths to .npz files</p></li>
<li><p><strong>path_to_save</strong> (<em>str</em>) – Path to save figure</p></li>
<li><p><strong>intervals_dict</strong> (<em>dict-like</em>) – <dl class="simple">
<dt>dict-like of interals:{‘pre_interval’<span class="classifier">int(.5*fps), # interval before laser onset</span></dt><dd><p>’interval’ : int(interval_in_sec * fps), # number of timebins of stimulation
‘post_interval’ : int(.5*fps*2), # interval after laser onset
‘pre_stim_inter’ : pre_stim_inter }</p>
</dd>
</dl>
</p></li>
<li><p><strong>pre_x_v_dict</strong> (<em>dict-like</em>) – <dl class="simple">
<dt>{‘back_front_boundary’<span class="classifier">(treadmill_len-elec_shock)/2, # set the limit below which is considered back of the treadmill</span></dt><dd><p>’v_threshold’ : 0,
‘pre_stim_inter’ : pre_stim_inter # number of timebins in the pre-stimulus period}</p>
</dd>
</dl>
</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – y axis limits for figure. Default is set to [-40,15]</p></li>
<li><p><strong>save_as_format</strong> (<em>str</em><em>, </em><em>optional</em>) – format to save the figure. Default is set to ‘.pdf’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.move_unwanter_files_out_of_folder">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">move_unwanter_files_out_of_folder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.move_unwanter_files_out_of_folder" title="Permalink to this definition"></a></dt>
<dd><p>move all non csv xlsx files out of the Laser and DLC subdirectory</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.moving_average_array">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">moving_average_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.moving_average_array" title="Permalink to this definition"></a></dt>
<dd><p>Return the moving average over X with window n without changing dimesions of X</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.no_files">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">no_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_no</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'DLC'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.no_files" title="Permalink to this definition"></a></dt>
<dd><p>Report True the there are no ‘dtype’
files for this mouse</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.plot_ON_OFF_measure">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">plot_ON_OFF_measure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back_front_boundary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_stim_inter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-</span> <span class="pre">1,</span> <span class="pre">2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_measure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'norm_velocity</span> <span class="pre">(mean)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['pre_velocity_sign',</span> <span class="pre">'epoch']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conditions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['pos',</span> <span class="pre">'neg']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['teal',</span> <span class="pre">'blueviolet']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lstyles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['-',</span> <span class="pre">'-']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.plot_ON_OFF_measure" title="Permalink to this definition"></a></dt>
<dd><p>Plot the mean laser-ON laser-OFF velocity measure with distinction of the groupby elements provided
prior to laser stim.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<em>dataframe</em>) – dataframe containing information of all animals</p></li>
<li><p><strong>pre_direct</strong> (<em>str</em>) – Path to save the figure</p></li>
<li><p><strong>opto_par</strong> (<em>str</em>) – optogenetic expression.</p></li>
<li><p><strong>mouse_type</strong> (<em>str</em>) – mouse line.</p></li>
<li><p><strong>stim_loc</strong> (<em>str</em>) – the folder with the corresponding experiment brain location e.g. “STR”.</p></li>
<li><p><strong>stim_type</strong> (<em>str</em>) – Folder containing the experiment sessions</p></li>
<li><p><strong>back_front_boundary</strong> (<em>float</em>) – Threshold to set the position of the animal before the laser onset as either ‘back’ or ‘front’</p></li>
<li><p><strong>v_threshold</strong> (<em>float</em>) – Threshold to set the velocity of the animal before the laser onset as either ‘pos’ or ‘neg’</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – Y axis limits for the figure, default set to [-20,15]</p></li>
<li><p><strong>axes</strong> (<em>list</em><em>(</em><em>Axes</em><em>)</em><em>, </em><em>optional</em>) – list of 2 Axes. The default is an empty list.</p></li>
<li><p><strong>velocity_measure</strong> (<em>[</em><em>'norm_velocity</em><em> (</em><em>mean</em><em>)</em><em>'</em><em>, </em><em>'norm_velocity</em><em> (</em><em>min</em><em>)</em><em>'</em><em>]</em>) – value reported in plot.</p></li>
<li><p><strong>save_as_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Format to save the figure default is ‘.pdf’</p></li>
<li><p><strong>{</strong><strong>[</strong><strong>]</strong> (<em>axes =</em>) – if axes provided the two conditions are plotted in separate axes. Otherwise will be plotted on the same axis.</p></li>
<li><p><strong>axes}</strong> – if axes provided the two conditions are plotted in separate axes. Otherwise will be plotted on the same axis.</p></li>
<li><p><strong>optional</strong> – if axes provided the two conditions are plotted in separate axes. Otherwise will be plotted on the same axis.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>(</em><em>default: True</em><em>)</em>) – if save figure.</p></li>
<li><p><strong>title</strong> (<em>bool</em><em>(</em><em>default=True</em><em>)</em>) – if put title.</p></li>
<li><p><strong>legend</strong> (<em>bool</em><em>(</em><em>default=True</em><em>)</em>) – if put legend.</p></li>
<li><p><strong>groupby</strong> (<em>{</em><em>[</em><em>'pre_velocity_sign'</em><em>, </em><em>epoch'</em><em>]</em><em>,</em>) – <blockquote>
<div><dl class="simple">
<dt>[‘pre_accel_sign’, epoch’],</dt><dd><p>[‘pre_accel_sign’, epoch’], ..}, optional</p>
</dd>
</dl>
</div></blockquote>
<p>The columns of result dataframe to group by.
Note that when providing three columns the conditions list should be adjusted to include the conditions
other that ‘epoch’ in each element. Default is [‘pre_velocity_sign’, epoch’].</p>
</p></li>
<li><p><strong>conditions</strong> (<em>{</em><em>[</em><em>'pos'</em><em>, </em><em>'neg'</em><em>]</em><em>,</em>) – [[‘pos’, ‘front’], [‘neg’, ‘front’]], …}, optional
The list of conditions to plot the measure for. the default is [‘pos’, ‘neg’].</p></li>
<li><p><strong>colors</strong> (<em>list of matplotlib colors</em><em>, </em><em>optional</em>) – list of colors for different conditions. The default is colors = [‘teal’, ‘blueviolet’].</p></li>
<li><p><strong>alphas</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – list of saturation alphas for the lines drawn.
The elements should correspond to the number of elements in conditions.The default is [1, 1].</p></li>
<li><p><strong>ls</strong> (<em>list of matplotlib linestyles</em><em>, </em><em>optional.</em>) – linestyles of each plotted line. The defautl is [‘-’, ‘-‘].</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.plot_ON_OFF_measure_with_x_distionction">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">plot_ON_OFF_measure_with_x_distionction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back_front_boundary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_stim_inter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-</span> <span class="pre">1,</span> <span class="pre">2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_measure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'norm_velocity</span> <span class="pre">(mean)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['pre_velocity_sign',</span> <span class="pre">'pre_x_front_back',</span> <span class="pre">'epoch']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conditions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[['pos',</span> <span class="pre">'front'],</span> <span class="pre">['neg',</span> <span class="pre">'front']]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['teal',</span> <span class="pre">'blueviolet']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lstyles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['-',</span> <span class="pre">'-']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_conditions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['front',</span> <span class="pre">'back']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.plot_ON_OFF_measure_with_x_distionction" title="Permalink to this definition"></a></dt>
<dd><p>Plot the mean laser-ON laser-OFF velocity measure with distinction of the groupby elements provided
prior to laser stim which includes position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<em>dataframe</em>) – dataframe containing information of all animals</p></li>
<li><p><strong>pre_direct</strong> (<em>str</em>) – Path to save the figure</p></li>
<li><p><strong>opto_par</strong> (<em>str</em>) – optogenetic expression.</p></li>
<li><p><strong>mouse_type</strong> (<em>str</em>) – mouse line.</p></li>
<li><p><strong>stim_loc</strong> (<em>str</em>) – the folder with the corresponding experiment brain location e.g. “STR”.</p></li>
<li><p><strong>stim_type</strong> (<em>str</em>) – Folder containing the experiment sessions</p></li>
<li><p><strong>back_front_boundary</strong> (<em>float</em>) – Threshold to set the position of the animal before the laser onset as either ‘back’ or ‘front’</p></li>
<li><p><strong>v_threshold</strong> (<em>float</em>) – Threshold to set the velocity of the animal before the laser onset as either ‘pos’ or ‘neg’</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – Y axis limits for the figure, default set to [-20,15]</p></li>
<li><p><strong>axes</strong> (<em>list</em><em>(</em><em>Axes</em><em>)</em><em>, </em><em>optional</em>) – list of 2 Axes. The default is an empty list.</p></li>
<li><p><strong>velocity_measure</strong> (<em>[</em><em>'norm_velocity</em><em> (</em><em>mean</em><em>)</em><em>'</em><em>, </em><em>'norm_velocity</em><em> (</em><em>min</em><em>)</em><em>'</em><em>]</em>) – value reported in plot.</p></li>
<li><p><strong>save_as_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Format to save the figure default is ‘.pdf’</p></li>
<li><p><strong>{</strong><strong>[</strong><strong>]</strong> (<em>axes =</em>) – if axes provided the two conditions are plotted in separate axes. Otherwise will be plotted on the same axis.</p></li>
<li><p><strong>axes}</strong> – if axes provided the two conditions are plotted in separate axes. Otherwise will be plotted on the same axis.</p></li>
<li><p><strong>optional</strong> – if axes provided the two conditions are plotted in separate axes. Otherwise will be plotted on the same axis.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>(</em><em>default: True</em><em>)</em>) – if save figure.</p></li>
<li><p><strong>title</strong> (<em>bool</em><em>(</em><em>default=True</em><em>)</em>) – if put title.</p></li>
<li><p><strong>legend</strong> (<em>bool</em><em>(</em><em>default=True</em><em>)</em>) – if put legend.</p></li>
<li><p><strong>groupby</strong> (<em>{</em><em>[</em><em>'pre_velocity_sign'</em><em>, </em><em>epoch'</em><em>]</em><em>,</em>) – <blockquote>
<div><dl class="simple">
<dt>[‘pre_accel_sign’, epoch’],</dt><dd><p>[‘pre_accel_sign’, epoch’], ..}, optional</p>
</dd>
</dl>
</div></blockquote>
<p>The columns of result dataframe to group by.
Note that when providing three columns the conditions list should be adjusted to include the conditions
other that ‘epoch’ in each element. Default is [‘pre_velocity_sign’, ‘pre_x_front_back’, ‘epoch’].</p>
</p></li>
<li><p><strong>conditions</strong> (<em>{</em><em>[</em><em>'pos'</em><em>, </em><em>'neg'</em><em>]</em><em>,</em>) – [[‘pos’, ‘front’], [‘neg’, ‘front’]], …}, optional
The list of conditions to plot the measure for. the default is  [[‘pos’, ‘front’], [‘neg’, ‘front’]].</p></li>
<li><p><strong>colors</strong> (<em>list of matplotlib colors</em><em>, </em><em>optional</em>) – list of colors for different conditions. The default is colors = [‘teal’, ‘blueviolet’].</p></li>
<li><p><strong>alphas</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – list of saturation alphas for the lines drawn.
The elements should correspond to the number of elements in conditions.The default is [1, 1].</p></li>
<li><p><strong>ls</strong> (<em>list of matplotlib linestyles</em><em>, </em><em>optional.</em>) – linestyles of each plotted line. The defautl is [‘-’, ‘-‘].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.plot_every_mouse_mean">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">plot_every_mouse_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epochs_mean_each_mouse</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.plot_every_mouse_mean" title="Permalink to this definition"></a></dt>
<dd><p>plot mean of each mouse for epochs OFF-ON-OFF</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.plot_pre_on_post">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">plot_pre_on_post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pre_direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs_spont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treadmill_velocity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_timebin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_veloc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body_part</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_stim_inter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all_mice'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_laser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'deepskyblue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_spont</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_spont</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'body-part'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotate_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axvspan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_label_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_label_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'upper</span> <span class="pre">left'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_to_anch_leg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.1,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.plot_pre_on_post" title="Permalink to this definition"></a></dt>
<dd><p>Plot (pre Laser | Laser | post Laser) velocity/position/acceleration comparison between laser and spontaneous trials.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>ax</em>) – </p></li>
<li><p><strong>pre_direct</strong> (<em>str</em>) – Path to project directory</p></li>
<li><p><strong>mouse_type</strong> (<em>str</em>) – Type of the animal that makes it different in the experiment e.g. for transgenic mice ‘FoxP2’ or ‘Vglut2’.</p></li>
<li><p><strong>opto_par</strong> (<em>str</em>) – Optogentic parameter distinguishing injections. e.g. ‘Control’ or ‘ChR2’.</p></li>
<li><p><strong>stim_loc</strong> (<em>str</em>) – the folder with the corresponding experiment brain location e.g. “STR”.</p></li>
<li><p><strong>stim_type</strong> (<em>str</em>) – folder containing this specific protocol’s sessions e.g. ‘Square_1_mW’</p></li>
<li><p><strong>epochs</strong> (<em>2D array</em><em>(</em><em>float</em><em>)</em>) – Trials containtning laser stimulation aligned in rows. n_col is equal to pre_interval + interval + post_interval</p></li>
<li><p><strong>epochs_spont</strong> (<em>2D array</em><em>(</em><em>float</em><em>)</em>) – Spontaneous trials aligned in rows. n_col is equal to pre_interval + interval + post_interval</p></li>
<li><p><strong>treadmill_velocity</strong> (<em>float</em>) – Treadmill velocity in cm/s</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>(</em><em>float</em><em>)</em>) – Y axis limits for the figure given as a list : [ymin, ymax]</p></li>
<li><p><strong>fps</strong> (<em>int</em>) – frame per second of the video</p></li>
<li><p><strong>n_timebin</strong> (<em>int</em>) – number of timebins for taking derivatives</p></li>
<li><p><strong>window_pos</strong> (<em>int</em>) – Moving average window for position</p></li>
<li><p><strong>window_veloc</strong> (<em>int</em>) – Moving average window for velocity</p></li>
<li><p><strong>cor</strong> (<em>str</em>) – Which coordinate to work with. e.g. ‘x’ or ‘y’</p></li>
<li><p><strong>body_part</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – Which body parts to average over.</p></li>
<li><p><strong>plot_param</strong> (<em>str</em>) – Parameter for analysis e.g. position or velocity.</p></li>
<li><p><strong>pre_interval</strong> (<em>int</em>) – Number of time bins to be taken into account before laser onset</p></li>
<li><p><strong>interval</strong> (<em>int</em>) – Laser duration in timebins.</p></li>
<li><p><strong>post_interval</strong> (<em>int</em>) – Number of time bins to be taken into account after laser onset</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
<li><p><strong>average</strong> (<em>str</em><em>, </em><em>optional</em>) – Parameter specifying the output figure. Here default set to ‘Averg_trials_all_mice’.</p></li>
<li><p><strong>c_laser</strong> (<em>str</em><em>, </em><em>optional</em>) – color for plotting trials with laser stimulation. Default value is set to ‘deepskyblue’.</p></li>
<li><p><strong>c_spont</strong> (<em>str</em><em>, </em><em>optional</em>) – color for plotting trials with laser stimulation. Default value is set to ‘k’ which is black.</p></li>
<li><p><strong>save_as_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Format to save the figure with. Default set to  ‘.pdf’</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.plot_two_protocols_with_mouse_distinction">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">plot_two_protocols_with_mouse_distinction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mouse_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.plot_two_protocols_with_mouse_distinction" title="Permalink to this definition"></a></dt>
<dd><p>Extract data over all mice of one group in two stim_types intensity and plot with subplots of individual animals</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.plot_velocity_phase_space">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">plot_velocity_phase_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back_front_boundary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_stim_inter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-</span> <span class="pre">1,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-</span> <span class="pre">1,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_measure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'norm_velocity</span> <span class="pre">(mean)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.pdf'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.plot_velocity_phase_space" title="Permalink to this definition"></a></dt>
<dd><p>Plot the phase space of laser-ON vs. laser-OFF velocity for all trials of all mice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<em>dataframe</em>) – dataframe containing information of all animals     pre_direct : str
Path to save the figure</p></li>
<li><p><strong>opto_par</strong> (<em>str</em>) – optogenetic expression.</p></li>
<li><p><strong>mouse_type</strong> (<em>str</em>) – mouse line.</p></li>
<li><p><strong>stim_loc</strong> (<em>str</em>) – the folder with the corresponding experiment brain location e.g. “STR”.</p></li>
<li><p><strong>stim_type</strong> (<em>str</em>) – Folder containing the experiment sessions</p></li>
<li><p><strong>back_front_boundary</strong> (<em>float</em>) – Threshold to set the position of the animal before the laser onset as either ‘back’ or ‘front’</p></li>
<li><p><strong>v_threshold</strong> (<em>float</em>) – Threshold to set the velocity of the animal before the laser onset as either ‘pos’ or ‘neg’</p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – X axis limits for the figure, default set to [-25,32]</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – Y axis limits for the figure, default set to [-20,15]</p></li>
<li><p><strong>velocity_measure</strong> (<em>[</em><em>'norm_velocity</em><em> (</em><em>mean</em><em>)</em><em>'</em><em>, </em><em>'norm_velocity</em><em> (</em><em>min</em><em>)</em><em>'</em><em>]</em>) – value reported in plot.</p></li>
<li><p><strong>save_as_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Format to save the figure default is ‘.pdf’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.plot_what_which_where">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">plot_what_which_where</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">laser_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_no</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_no</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">misdetection_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body_part</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_timebin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_veloc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.pdf'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.plot_what_which_where" title="Permalink to this definition"></a></dt>
<dd><p>Choose to see averaged velocity, position or acceleration for a chosen combination of body_parts
for either x or y coordiante.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.plot_what_which_where_r_l">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">plot_what_which_where_r_l</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">laser_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_no</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_no</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">misdetection_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body_part</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_timebin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_veloc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.pdf'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.plot_what_which_where_r_l" title="Permalink to this definition"></a></dt>
<dd><p>Choose which body part/what measure/ x or y to see the left vs. right traces.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.position_r_l">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">position_r_l</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">misdetection_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body_part</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_param</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.position_r_l" title="Permalink to this definition"></a></dt>
<dd><p>Remove jitters with “correct_labeling_jitter” on right and left on the
selected body parts and return right and left separately.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>dataframe</em>) – Dataframe derived from DLC for one session of one animal</p></li>
<li><p><strong>window</strong> (<em>int</em>) – Moving average window for smoothing the position time series</p></li>
<li><p><strong>misdetection_dict</strong> (<em>dict-like</em>) – dict-like containing constants for misdetection corrections</p></li>
<li><p><strong>cor</strong> (<em>str</em>) – Which coordinate to work with. e.g. ‘x’ or ‘y’</p></li>
<li><p><strong>body_part</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – Which body parts to average over.</p></li>
<li><p><strong>plot_param</strong> (<em>str</em>) – Parameter for analysis e.g. position or velocity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>right_corrected</strong> (<em>1-D array</em>) – Moving average of right side for all selected body-parts</p></li>
<li><p><strong>left_corrected</strong> (<em>1-D array</em>) – Moving average of left side for all selected body-parts</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.produce_random_bins_for_spont">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">produce_random_bins_for_spont</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_trials_spont</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.produce_random_bins_for_spont" title="Permalink to this definition"></a></dt>
<dd><p>Produce a grid for start of bins then perturb to have randomly
spaced trials with a minimum and maximum distance between them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_time</strong> (<em>int</em>) – number of timebins of the spontaneous session</p></li>
<li><p><strong>n_sample</strong> (<em>int</em>) – number of trial samples that needs to be extracted from this session</p></li>
<li><p><strong>max_distance</strong> (<em>int</em>) – maximum number of timebins between extracted trials</p></li>
<li><p><strong>min_distance</strong> (<em>int</em>) – minimum number of timebins between extracted trials</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>bins</strong> – an array with two columns each row containing (start,end) of each trial</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D-array(int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.read_DLC">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">read_DLC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_pix_to_cm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.read_DLC" title="Permalink to this definition"></a></dt>
<dd><p>Read DeepLabCut trackings of bodyparts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<em>str</em>) – path of the DLC file.</p></li>
<li><p><strong>scale_pix_to_cm</strong> (<em>float</em>) – scaling factor to transform DLC pixel values into cm.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raises error if file type is not csv or xlsx.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>df</strong> – DLC output dataframe.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.read_laser">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">read_laser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">laser_file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DLC_file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.read_laser" title="Permalink to this definition"></a></dt>
<dd><p>Read laser onset offset times for Square pulse stimulation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.read_laser_beta_stim">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">read_laser_beta_stim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">laser_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_t_between_stim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.read_laser_beta_stim" title="Permalink to this definition"></a></dt>
<dd><p>Read laser onset offset times for laser detections of every
beta cycle (Gilles’s)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.remove_epochs_with_unaccep_pre_post_interval">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">remove_epochs_with_unaccep_pre_post_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session_length</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.remove_epochs_with_unaccep_pre_post_interval" title="Permalink to this definition"></a></dt>
<dd><p>Remove trials where extending the width to pre interval and post
interval exceeds the session boundaries</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.remove_xlsx_if_csv_exists">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">remove_xlsx_if_csv_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.remove_xlsx_if_csv_exists" title="Permalink to this definition"></a></dt>
<dd><p>remove matching xlsx if the equivalent csv file exists</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.rename_laser_files_according_to_DLC">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">rename_laser_files_according_to_DLC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.rename_laser_files_according_to_DLC" title="Permalink to this definition"></a></dt>
<dd><p>rename matching the laser files to DLC files</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.rm_shared_axis_labels">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">rm_shared_axis_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.rm_shared_axis_labels" title="Permalink to this definition"></a></dt>
<dd><p>Remove repeated axis labels</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.rm_val_from_dict_if_exists_in_another">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">rm_val_from_dict_if_exists_in_another</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictionary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_dictionary</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.rm_val_from_dict_if_exists_in_another" title="Permalink to this definition"></a></dt>
<dd><p>remove values that exist in the same key of
the ref dictionary from dictionary and return</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.run_one_intensity_save_data">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">run_one_intensity_save_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pre_direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_pix_to_cm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treadmill_velocity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spont_trial_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">misdetection_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_window_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accep_interval_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study_param_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_trials_spont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_laser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'deepskyblue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_spont</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_inner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_empty_ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotate_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_manually</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_spont</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suptitle_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axvspan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_label_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_label_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.run_one_intensity_save_data" title="Permalink to this definition"></a></dt>
<dd><p>Save data of epochs and individal mice to a npz file.</p>
<p>by running over all mice of one group and one intensity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pre_direct</strong> (<em>str</em>) – path to rooot directory</p></li>
<li><p><strong>scale_pix_to_cm</strong> (<em>float</em>) – SCaling coefficient for converting pixels to cm.</p></li>
<li><p><strong>mouse_type</strong> (<em>str</em>) – mouse type such as <cite>FoxP2</cite> etc</p></li>
<li><p><strong>mouse_list</strong> (<em>list</em><em>(</em><em>int</em><em>)</em>) – list of mouse identification numbers</p></li>
<li><p><strong>stim_loc</strong> (<em>str</em>) – the folder with the corresponding experiment brain location e.g. “STR”.</p></li>
<li><p><strong>stim_type</strong> (<em>str</em>) – the folder with the corresponding experiment protocol e.g. “Square_1_mW”.</p></li>
<li><p><strong>opto_par</strong> (<em>str</em>) – <cite>ChR2</cite> for ChR2 injected animals <cite>Control</cite> for Control group</p></li>
<li><p><strong>treadmill_velocity</strong> (<em>float</em>) – Treadmill velocity in <cite>cm/s</cite></p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>(</em><em>float</em><em>)</em>) – </p></li>
<li><p><strong>spont_trial_dict</strong> (<em>dict-like</em>) – <dl class="simple">
<dt>dict-like with values<span class="classifier">{‘max_distance’</span><span class="classifier">int(4.5*fps), # max #n_timebines between sampled epochs for spontaneous</span></dt><dd><p>’min_distance’ : int(3*fps), # min #n_timebines between sampled epochs for spontaneous
‘n_trials_spont’ : 25 # the average number of trials extracted from one spontaneous session}</p>
</dd>
</dl>
</p></li>
<li><p><strong>misdetection_dict</strong> (<em>dict-like</em>) – dictionary of constants used in the misdetection correction algorithm:</p></li>
<li><p><strong>intervals_dict</strong> (<em>dict-like</em>) – <dl class="simple">
<dt>dict-like of interals:{‘pre_interval’<span class="classifier">int(.5*fps), # interval before laser onset</span></dt><dd><p>’interval’ : int(interval_in_sec * fps), # number of timebins of stimulation
‘post_interval’ : int(.5*fps*2), # interval after laser onset
‘pre_stim_inter’ : pre_stim_inter }</p>
</dd>
</dl>
</p></li>
<li><p><strong>t_window_dict</strong> (<em>dict-like</em>) – dict-like containing information about time contants of the project:
t_window_dict = {<cite>fps</cite> : int, ‘n_timebin’ : int, ‘window_pos’ : int , ‘window_veloc’ : int}</p></li>
<li><p><strong>accep_interval_range</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>) – Smallest and largest acceptable trial sizes in timebins</p></li>
<li><p><strong>study_param_dict</strong> (<em>dictionray</em>) – dict-like of values regarding coordinate (x,y), body part (list of body parts) and plot parameter
(position, velocity, acceleration) packed from input of user</p></li>
<li><p><strong>max_distance</strong> (<em>int</em>) – maximum number of frames between sampled epochs for spontaneous</p></li>
<li><p><strong>min_distance</strong> (<em>int</em>) – mainimum number of frames between sampled epochs for spontaneous</p></li>
<li><p><strong>n_trials_spont</strong> (<em>int</em>) – number of spontaneous trials</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.save_npz">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">save_npz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pre_direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_timebin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name_ext</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs_all_mice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs_mean_each_mouse</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs_spont_all_mice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_no_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body_part</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_param</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.save_npz" title="Permalink to this definition"></a></dt>
<dd><p>Save the trial epochs in one .npz file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pre_direct</strong> (<em>str</em>) – path to rooot directory</p></li>
<li><p><strong>mouse_type</strong> (<em>str</em>) – mouse type such as ‘FoxP2’ or ..</p></li>
<li><p><strong>opto_par</strong> (<em>str</em>) – “ChR2” –&gt; for ChR2 injected animals
“Control” –&gt; for Control group</p></li>
<li><p><strong>stim_loc</strong> (<em>str</em>) – the folder with the corresponding experiment brain location e.g. “STR”.</p></li>
<li><p><strong>stim_type</strong> (<em>str</em>) – the folder with the corresponding experiment protocol e.g. “Square_1_mW”.</p></li>
<li><p><strong>pulse_inten</strong> (<em>int</em>) – Pulse intensity in mW</p></li>
<li><p><strong>fps</strong> (<em>int</em>) – Frame per second</p></li>
<li><p><strong>window</strong> (<em>int</em>) – Moving average window for position</p></li>
<li><p><strong>n_timebin</strong> (<em>int</em>) – Number of frames to take derivative over</p></li>
<li><p><strong>file_name_ext</strong> (<em>str</em>) – File name extension</p></li>
<li><p><strong>epochs_all_mice</strong> (<em>2D-array</em><em>(</em><em>float</em><em>)</em>) – (pre | Laser ON | post) epochs with shape (n_trials, pre_interval+post_interval+interval+1)</p></li>
<li><p><strong>epochs_mean_each_mouse</strong> (<em>2D-array</em><em>(</em><em>float</em><em>)</em>) – average of (pre | Laser ON | post) epochs with shape (n_animals, 3)
averaged for individual animals</p></li>
<li><p><strong>epochs_spont_all_mice</strong> (<em>2D-array</em><em>(</em><em>float</em><em>)</em>) – (pre | Laser ON | post) spontaneous epochs with shape (n_trials, pre_interval+post_interval+interval+1)</p></li>
<li><p><strong>epochs_tag</strong> (<em>1D-array</em><em>(</em><em>str</em><em>)</em>) – trial tags of each extracted laser epoch.</p></li>
<li><p><strong>pre_info</strong> (<em>2D array</em><em>(</em><em>float</em><em>)</em>) – Three columns with averages of : pre_x , pre_v, pre_acceleration over pre_stim_interval duration.
with shape (n_trials, 3)</p></li>
<li><p><strong>cor_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – list of available coordinates e.g. ‘x’, ‘y’</p></li>
<li><p><strong>body_part_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – list of DLC labeled body parts</p></li>
<li><p><strong>plot_param_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – List of available parameters for analysis e.g position or velocity.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.save_npz_limb_and_tail">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">save_npz_limb_and_tail</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pre_direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_pix_to_cm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">misdetection_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_window_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accep_interval_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cor_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body_part_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_param_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.save_npz_limb_and_tail" title="Permalink to this definition"></a></dt>
<dd><p>Save data of epochs and individal mice to a npz file.</p>
<p>Run over all mice of one group and one intensity append epochs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pre_direct</strong> (<em>str</em>) – path to rooot directory</p></li>
<li><p><strong>scale_pix_to_cm</strong> (<em>float</em>) – Scaling coeficient for pixels to cm.</p></li>
<li><p><strong>mouse_type</strong> (<em>str</em>) – mouse type such as <cite>FoxP2</cite> or etc</p></li>
<li><p><strong>mouse_list</strong> (<em>list</em><em>(</em><em>int</em><em>)</em>) – list of mouse identification numbers</p></li>
<li><p><strong>stim_loc</strong> (<em>str</em>) – the folder with the corresponding experiment brain location e.g. “STR”.</p></li>
<li><p><strong>stim_type</strong> (<em>str</em>) – the folder with the corresponding experiment protocol e.g. <cite>Square_1_mW</cite></p></li>
<li><p><strong>opto_par</strong> (<em>str</em>) – <cite>ChR2</cite> for ChR2 injected animals, <cite>Control</cite> for Control group</p></li>
<li><p><strong>misdetection_dict</strong> (<em>dict-like</em>) – dictionary of constants used in the misdetection correction algorithm</p></li>
<li><p><strong>pre_interval</strong> (<em>int</em>) – Number of time bins to be taken into account before laser onset</p></li>
<li><p><strong>interval</strong> (<em>int</em>) – Laser duration in timebins.</p></li>
<li><p><strong>post_interval</strong> (<em>int</em>) – Number of time bins to be taken into account after laser onset</p></li>
<li><p><strong>t_window_dict</strong> (<em>dict-like</em>) – dictionary containing information about time contants of the project</p></li>
<li><p><strong>accep_interval_range</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>) – Smallest and largest acceptable trial sizes in timebins</p></li>
<li><p><strong>cor_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – list of available coordinates e.g. <cite>x</cite>, <cite>y</cite></p></li>
<li><p><strong>body_part_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – list of DLC labeled body parts</p></li>
<li><p><strong>plot_param_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – List of available parameters for analysis e.g position or velocity</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.save_pdf_png">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">save_pdf_png</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(8,</span> <span class="pre">6)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.save_pdf_png" title="Permalink to this definition"></a></dt>
<dd><p>Save fig as pdf and png format</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.set_ticks">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">set_ticks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.set_ticks" title="Permalink to this definition"></a></dt>
<dd><p>set tick length and label fontsize</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.set_x_ticks_one_ax">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">set_x_ticks_one_ax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.set_x_ticks_one_ax" title="Permalink to this definition"></a></dt>
<dd><p>set x axis tick labels from list</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>obj</em>) – plot axis.</p></li>
<li><p><strong>label_list</strong> (<em>list</em><em> (</em><em>int</em><em>)</em>) – x axis tick labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ax</strong> – plot axis.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.set_xy_ticks_one_ax">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">set_xy_ticks_one_ax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_label_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_label_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.set_xy_ticks_one_ax" title="Permalink to this definition"></a></dt>
<dd><p>set x and y axis tick labels from list</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>obj</em>) – plot axis.</p></li>
<li><p><strong>x_label_list</strong> (<em>list</em><em> (</em><em>int</em><em>)</em>) – x axis tick labels.</p></li>
<li><p><strong>y_label_list</strong> (<em>list</em><em> (</em><em>int</em><em>)</em>) – y axis tick labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ax</strong> – plot axis.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.set_y_ticks_one_ax">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">set_y_ticks_one_ax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.set_y_ticks_one_ax" title="Permalink to this definition"></a></dt>
<dd><p>set y axis tick labels from list</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>obj</em>) – plot axis.</p></li>
<li><p><strong>label_list</strong> (<em>list</em><em> (</em><em>int</em><em>)</em>) – y axis tick labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ax</strong> – plot axis.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.superimpose_intensities">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">superimpose_intensities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opto_par_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pulse_cmap_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">protocol_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_loc_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_pix_to_cm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treadmill_velocity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spont_trial_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">misdetection_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_window_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accep_interval_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study_param_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_trials_spont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_spont</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suptitle_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.98</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_spont</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_label_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_label_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.superimpose_intensities" title="Permalink to this definition"></a></dt>
<dd><p>Create a set of subplots with mice as rows and stimulation location as
columns, superimposeing all intensities and creating new figures for different
types of stimuli</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.violin_plot_laser_ON_OFF">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">violin_plot_laser_ON_OFF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pre_direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_color_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'stim_loc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_measure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'norm_velocity</span> <span class="pre">(mean)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_loc_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">summary_files_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pulse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.violin_plot_laser_ON_OFF" title="Permalink to this definition"></a></dt>
<dd><p>Plot distributions of normalized velocity in the laser ON and OFF epochs as subplots
distinguishing the subplot_parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pre_direct</strong> (<em>str</em>) – Path to the root directory of the project</p></li>
<li><p><strong>intervals_dict</strong> (<em>dict-like</em>) – <dl class="simple">
<dt>dict-like of intervals:{‘pre_interval’<span class="classifier">int(.5*fps), # interval before laser onset</span></dt><dd><p>’interval’ : int(interval_in_sec * fps), # number of timebins of stimulation
‘post_interval’ : int(.5*fps*2), # interval after laser onset
‘pre_stim_inter’ : pre_stim_inter</p>
</dd>
</dl>
</p></li>
<li><p><strong>opto_par</strong> (<em>str</em>) – optogenetic expression.</p></li>
<li><p><strong>mouse_color_dict</strong> (<em>dict-like</em>) – dictionary of colors for each mouse number.</p></li>
<li><p><strong>mouse_type</strong> (<em>str</em>) – mouse line.</p></li>
<li><p><strong>subplot_parameter</strong> (<em>str</em><em>, </em><em>optional</em>) – The parameter changing between the columns e.g. laser internsity or stim location. The default is ‘stim_loc’.</p></li>
<li><p><strong>fig_w</strong> (<em>float</em><em>, </em><em>optional</em>) – individual double column width in inches. The default is 1.</p></li>
<li><p><strong>fig_h</strong> (<em>float</em><em>, </em><em>optional</em>) – figure height in inches. The default is 4.</p></li>
<li><p><strong>velocity_measure</strong> (<em>{'norm_velocity</em><em> (</em><em>mean</em><em>)</em><em>'</em><em>, </em><em>'norm_velocity</em><em> (</em><em>min</em><em>)</em><em>'}</em><em>, </em><em>optional</em>) – the measurement of the laser-ON and -OFF epochs.</p></li>
<li><p><strong>stim_type_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em><em>, </em><em>optional</em>) – type of stimulation that includes the pulse type and intensity. The default is None.</p></li>
<li><p><strong>stim_loc_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em><em>, </em><em>optional</em>) – list of stimulation brain structures.. The default is None.</p></li>
<li><p><strong>summary_files_list</strong> (<em>list</em><em>(</em><em>str</em><em>)</em><em>, </em><em>optional</em>) – list of filepaths of experiments. The default is None where the function searches for the provided
stim types and locs for the specified mouse type, otherwise input list is used.</p></li>
<li><p><strong>savefig</strong> (<em>bool</em><em>, </em><em>True</em>) – if save generated figure.</p></li>
<li><p><strong>pulse</strong> (<em>str</em><em>, </em><em>optional</em>) – stimulation type, to be added to the figname when subplot parameter is intensity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ax</strong> – plot axis.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.violin_plot_summary">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">violin_plot_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measure</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.violin_plot_summary" title="Permalink to this definition"></a></dt>
<dd><p>plot violin plot for different columns in data</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Locomotion.violin_plot_with_distiction">
<span class="sig-prename descclassname"><span class="pre">Locomotion.</span></span><span class="sig-name descname"><span class="pre">violin_plot_with_distiction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_direct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opto_par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back_front_boundary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_stim_inter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-</span> <span class="pre">1.5,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_measure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'norm_velocity</span> <span class="pre">(mean)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">violin_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_distinction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'area'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['teal',</span> <span class="pre">'blueviolet']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_conditions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['pos',</span> <span class="pre">'neg']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_conditions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['front',</span> <span class="pre">'back']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">0.6]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['-',</span> <span class="pre">'--']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pre_velocity_sign'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Locomotion.violin_plot_with_distiction" title="Permalink to this definition"></a></dt>
<dd><p>Plot violin plots with columns for pre laser velocity
distinction and hue for back and front distinction on the treadmill.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<em>dataframe</em>) – dataframe containing information of all animals</p></li>
<li><p><strong>pre_direct</strong> (<em>str</em>) – Path to save the figure</p></li>
<li><p><strong>opto_par</strong> (<em>str</em>) – optogenetic expression.</p></li>
<li><p><strong>mouse_type</strong> (<em>str</em>) – mouse line.</p></li>
<li><p><strong>stim_loc</strong> (<em>str</em>) – the folder with the corresponding experiment brain location e.g. “STR”.</p></li>
<li><p><strong>stim_type</strong> (<em>str</em>) – Folder containing the experiment sessions</p></li>
<li><p><strong>back_front_boundary</strong> (<em>float</em>) – Threshold to set the position of the animal before the laser onset as either <cite>back</cite> or <cite>front</cite></p></li>
<li><p><strong>v_threshold</strong> (<em>float</em>) – Threshold to set the velocity of the animal before the laser onset as either <cite>pos</cite> or <cite>neg</cite></p></li>
<li><p><strong>pre_stim_inter</strong> (<em>int</em>) – Pre interval for averaging the positions/velocity and accelaration and report as pre_info</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – <p>Y axis limits for the figure, default set to [-1, 2]
velocity_measure: [‘norm_velocity (mean)’, ‘norm_velocity (min)’]</p>
<blockquote>
<div><p>value reported in plot.</p>
</div></blockquote>
</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – transparency of distribution</p></li>
<li><p><strong>x_distinction</strong> (<em>True</em><em>, </em><em>optional</em>) – Whether separate x position as hue. Default is True</p></li>
<li><p><strong>save_as_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Format to save the figure default is ‘.pdf’</p></li>
<li><p><strong>scale</strong> (<em>{“area”</em><em>, </em><em>“count”</em><em>, </em><em>“width”}</em><em>, </em><em>optional</em>) – The method used to scale the width of each violin.
If <cite>area</cite>, each violin will have the same area.
If <cite>count</cite>, the width of the violins will be scaled by the number of observations in that bin. If <cite>width</cite>, each violin will have the same width. The default is ‘area’.</p></li>
<li><p><strong>colors</strong> (<em>list of matplotlib colors</em><em>, </em><em>optional</em>) – list of colors for different conditions. The default is [‘teal’, ‘blueviolet’].</p></li>
<li><p><strong>velocity_conditions</strong> (<em>list</em><em>(</em><em>str</em><em>)</em><em>, </em><em>optional</em>) – The conditions for the <cite>pre_velocity_sign</cite> column of the data. The default is [‘pos’, ‘neg’].</p></li>
<li><p><strong>position_conditions</strong> (<em>list</em><em>(</em><em>str</em><em>)</em><em>, </em><em>optional</em>) – The conditions for the <cite>pre_x_front_back</cite> column of the data. The default is [‘front’, ‘back’].</p></li>
<li><p><strong>alphas</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – list of saturation alphas for the lines drawn.
The elements should correspond to the number of elements in conditions.The default is [1, 1].</p></li>
<li><p><strong>ls</strong> (<em>list of matplotlib linestyles</em><em>, </em><em>optional.</em>) – linestyles of each plotted line. The defautl is [‘-’, ‘-‘].</p></li>
<li><p><strong>column</strong> (<em>str</em><em>, </em><em>optional</em>) – The measure that separates the columns of the catplot. The default is ‘pre_velocity_sign’.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Locomotion" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Locomotion_task.html" class="btn btn-neutral float-right" title="Locomotion Task Analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Shiva A. Lindi.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>